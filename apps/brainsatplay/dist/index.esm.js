var Xt=Object.defineProperty;var k=(e,t)=>{for(var o in t)Xt(e,o,{get:t[o],enumerable:!0})};var ke={};k(ke,{content:()=>co,footer:()=>po,nav:()=>lo});var ce={};k(ce,{__onconnected:()=>Zt,container:()=>Qt});function Zt(){this.header!==void 0&&(this.container.header.__element.innerText=this.header),this.text!==void 0&&(this.container.text.__element.innerHTML=this.text)}var Qt={header:{__element:"h3",__attributes:{innerText:"Header"}},text:{__element:"p",__attributes:{innerHTML:"This is the text."}}};var ee={};k(ee,{__attributes:()=>to,__onconnected:()=>eo,container:()=>oo});function eo(){["number","title","description"].forEach(t=>{this[t]!==void 0&&(this.container[t].__element.innerText=this[t])}),this.projects!==void 0&&this.projects.forEach(t=>{let o=document.createElement("li"),n=document.createElement("a"),r=document.createElement("sub");r.style.fontSize="75%",r.style.userSelect="none",t.active===!1?(o.style.opacity="0.5",o.style.pointerEvents="none",o.style.userSelect="none"):(t.oncreate&&t.oncreate(o),t.onclick?n.onclick=t.onclick:t.href&&(n.href=t.href)),o.appendChild(n),o.appendChild(r),n.innerText=t.name,r.innerText=` ${t.version}`,this.container.projects.__element.appendChild(o)})}var to={style:{padding:"1rem"}},oo={number:{__element:"p",__attributes:{innerText:"",style:{fontSize:"0.9rem",paddingBottom:"0.5rem",margin:"0px"}}},title:{__element:"h3",__attributes:{innerText:"Feature"}},description:{__element:"p",__attributes:{innerText:"This is a feature that is featured."}},projects:{__element:"ul"}};var Oe={};k(Oe,{__element:()=>io,__onconnected:()=>ao,channel:()=>no,height:()=>so,width:()=>ro});var no="brainsatplay",ro="100%",so=480,io="div",ao=function(){let e=document.createElement("script");e.src="https://embed.twitch.tv/embed/v1.js",document.body.appendChild(e),e.onload=()=>{new Twitch.Embed(this.__element,{width:this.width,height:this.height,channel:this.channel})}};var nt={borderBottom:"2px solid white",paddingBottom:"0.5rem",paddingRight:"1rem"},rt={list:[],__element:"ul",__onconnected:function(){this.__element.innerHTML="",this.list.forEach(e=>{let t=document.createElement("li"),o=document.createElement("a");o.innerText=e.label,t.appendChild(o),this.__element.appendChild(t),e.oncreate&&e.oncreate(t),e.onclick?o.onclick=e.onclick:o.href=e.href})}},st=[{label:"Home",href:"/"},{label:"About",href:"#about"},{label:"Work",href:"#work"},{label:"Ethos",href:"#ethos"},{label:"Twitch",href:"#twitch"}],lo={__element:"nav",__childposition:0,__attributes:{style:{position:"fixed",top:"0px",right:"0px",paddingRight:"2rem"}},list:{list:st,__compose:rt,__attributes:{style:{textTransform:"uppercase"}}}},co={__element:"main",__childposition:0,hero:{__element:"section",__childposition:0,container:{title:{__element:"h1",__attributes:{innerText:"Brains@Play"}},subtitle:{__element:"h2",__attributes:{innerText:"The Universal Web Development Cooperative"}},description:{__element:"p",__attributes:{innerText:"We empower everyone to build better apps\u2014together."}}}},about:{__element:"section",__childposition:1,__attributes:{style:{background:"darkslategray"}},container:{title:{text:{__element:"h2",__attributes:{innerText:"About Us"}},support:{__element:"a",__attributes:{href:"https://opencollective.com/brainsatplay",target:"_blank"},image:{__element:"img",__attributes:{height:40,src:"https://opencollective.com/brainsatplay/contribute/button@2x.png?color=white"}}},__attributes:{style:{display:"flex",justifyContent:"space-between",alignItems:"center",...nt}}},description:{__element:"p",__attributes:{innerHTML:"Brains@Play is currently led by two developers\u2014<a href='https://github.com/garrettmflynn' target='_blank'>Garrett Flynn</a> and <a href='https://github.com/garrettmflynn' target='_blank'>Joshua Brewster</a>\u2014working to build a better Web with free software."}},statements:{__attributes:{style:{display:"flex",flexWrap:"wrap"}},mission:{header:"Mission",text:"Make code universally <a>shareable</a>, <a>modifiable</a>, and <a>usable</a>.",__compose:ce,__attributes:{style:{flexBasis:"50%",padding:"15px"}}},vision:{header:"Vision",text:"Engulf the Web in public experiments of communal organization and citizen science, engineering, and art.",__compose:ce,__attributes:{style:{flexBasis:"50%",padding:"15px"}}}}}},ethos:{__element:"section",__childposition:2,container:{title:{__element:"h2",__attributes:{innerText:"Our Ethos",style:{...nt}}},featureone:{number:"1",title:"Recompose the Web",description:"We are consuming the infrastructure of the Web.",projects:[{name:"ES Components (ESC)",link:"https://github.com/brainsatplay/escomponent",version:"0.1.7",description:"A specification for composable JavaScript objects with concurrent message-passing."},{name:"ESCode",link:"https://github.com/brainsatplay/escode",version:"0.2.0",description:"A framework for using ES Components using graphscript."},{name:"Web Source Accessibility Guidelines (WSAG)",active:!1,version:"0.0.0",description:"Identify best practices to allow anyone to use, modify, and share Web Components."}],__compose:ee},featuretwo:{number:"2",title:"Make Software Yours",description:"Bring yourself to every page.",projects:[{name:"Browser Extension",link:"https://github.com/brainsatplay/brainsatplay-extension",version:"0.0.0",oncreate:e=>{let t="brainsatplay-injection-proxy",o=r=>{window.postMessage({source:r,command:"openOptions"})},n=()=>{let r=!1;e.onclick=()=>{let i="https://github.com/brainsatplay/brainsatplay-extension";window.open(i,"_blank")};let s=document.getElementById(t);if(s&&s.getAttribute("data-version")){let a=s.getAttribute("data-id");r=!0,e.onclick=()=>o(a)}return r};window.onload=function(){n()||setTimeout(n,100)}},description:"Apply components across web pages."},{name:"Desktop App",link:"https://github.com/brainsatplay/brainsatplay-electron",version:"0.0.0",onclick:()=>{customProtocolCheck("brainsatplay://",()=>{window.open("https://github.com/brainsatplay/brainsatplay-desktop","_blank"),console.log("Custom protocol not found.")},()=>{console.log("Custom protocol found and opened the file successfully.")})},description:"Create composable cross-platform web systems."}],__compose:ee},featurethree:{number:"3",title:"Free Public Experimentation",description:"We are supporting new scientific and human-computer interaction (HCI) advances that drive experimentation on the Web and translate quickly across sites.",projects:[{name:"WebNWB",link:"https://github.com/brainsatplay/webnwb",description:"Enable citizen neuroscience.",version:"0.0.12"},{name:"MyAlyce",link:"https://myalyce.com",description:"Enable citizen neuroscience.",version:"0.0.0"}],__compose:ee}}},twitch:Oe},po={__element:"footer",__childposition:2,__attributes:{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",backgroundColor:"black",color:"white",padding:"25px 50px"}},title:{text:{__element:"span",__attributes:{innerText:"\xA9 Brains@Play 2022"}}},links:{__compose:rt,list:[...st]},social:{__element:"ul",email:{__element:"li",link:{__element:"a",__attributes:{href:"mailto:contact@brainsatplay.com",innerText:"contact@brainsatplay.com"}}},newsletter:{__element:"li",link:{__element:"a",__attributes:{href:"https://brainsatplay.substack.com",innerText:"Sign up for our newsletter",style:{fontSize:"0.8rem"}}}}}};var Ce={};k(Ce,{hero:()=>fo});var fo={__element:"section",container:{title:{__element:"h1",__childposition:0,__attributes:{innerText:"About Us"}},subtitle:{__element:"h2",__childposition:1,__attributes:{innerText:"It all began with a dream of agency for every brain."}},description:{__element:"p",__childposition:2,__attributes:{innerText:"We started working in 2021 and never stopped."}},message:{__element:"p",__childposition:3,__attributes:{innerText:"Now it's cool to have a brain!"}}}};var Ie={};k(Ie,{hero:()=>uo});var uo={__element:"section",container:{title:{__element:"h1",__attributes:{innerText:"Our Work"}},subtitle:{__element:"h2",__attributes:{innerText:"The Universal Web Development Cooperative"}}}};var mo="[object Module]",W=e=>!!(e&&(!!Object.keys(e).reduce((o,n)=>{let r=Object.getOwnPropertyDescriptor(e,n),s=r&&r.get&&!r.set?1:0;return o+s},0)||Object.prototype.toString.call(e)===mo));var at=(e,t)=>{if(e&&typeof e=="object"&&t&&typeof t=="object"){let o=JSON.stringify(e),n=JSON.stringify(t);return o===n}else return e===t},B=(e,t)=>Promise.all(Object.getOwnPropertySymbols(e).map(o=>t(o,e[o]))),C=(e,t)=>{let o=t.path[e];if(!o)throw new Error("Invalid Path Type");return o.filter(r=>typeof r=="string").join(t.keySeparator)},pe=(e,t)=>{let o=e;return typeof e=="string"?o=e.split(t.keySeparator):typeof e=="symbol"&&(o=[e]),{id:o[0],path:o.slice(1)}},N=(e,t,o,n,r=!0)=>{if(e instanceof Function&&(n&&typeof n=="object"&&typeof n.then=="function"?n.then(s=>e(t,o,s)):e(t,o,n)),r&&globalThis.ESMonitorState){let s=globalThis.ESMonitorState.callback;globalThis.ESMonitorState.state[t]={output:n,value:o},N(s,t,o,n,!1)}};var ho=60,te=class{constructor(t,o){this.listeners={};this.setOptions=(t={})=>{for(let o in t)this[o]=t[o]};this.add=t=>{let o=t.sub;return this.listeners[o]=t,this.start(),!0};this.get=t=>this.listeners[t];this.remove=t=>{delete this.listeners[t],Object.keys(this.listeners).length||this.stop()};this.poll=t=>{B(t,(o,n)=>{let{callback:r,current:s,history:i}=n;n.path.resolved||(n.path.resolved=C("output",n)),at(s,i)||(N(r,n.path.resolved,{},s),typeof s=="object"?Array.isArray(s)?i=[...s]:i={...s}:t[o].history=s)})};this.start=(t=this.listeners)=>{this.sps?this.#e||(console.warn("[esmonitor]: Starting Polling!"),this.#e=setInterval(()=>this.poll(t),1e3/this.sps)):this.sps=ho};this.stop=()=>{this.#e&&(console.warn("[esmonitor]: Stopped Polling!"),clearInterval(this.#e),this.#e=void 0)};t&&(this.listeners=t),o&&(this.sps=o)}#e;#t;get sps(){return this.#t}set sps(t){this.#t=t;let o=this.listeners;Object.keys(o).length&&(this.stop(),this.start())}};var ne={};k(ne,{functionExecution:()=>de,functions:()=>yt,getProxyFunction:()=>Re,info:()=>be,register:()=>ht,set:()=>Fe,setterExecution:()=>he,setters:()=>Me});globalThis.ESMonitorState={state:{},callback:void 0,info:{}};var ct=globalThis.ESMonitorState;var yo=async(e,t)=>{let o=globalThis.performance.now(),n=await e(...t),r=globalThis.performance.now();return{output:n,value:r-o}},pt={performance:yo},ft=(e,t,o)=>{let n={value:{},output:void 0},r={...ct.info,...o};for(let s in r)if(r[s]&&pt[s]){let i=e;e=async(...a)=>{let p=await pt[s](i,a);return n.value[s]=p.value,p.output}}return n.output=e(...t),n};var I=Symbol("isProxy"),oe=Symbol("fromInspectable"),Gn=Symbol("fromInspectableHandler");var j=".",go="default",H="__esmpileSourceBundle",je={isGraphScript:"__",properties:"__props",default:go,parent:"__parent",promise:"__childresolved",component:"__component",proxy:"__proxy"},l={...je,start:"__onconnected",stop:"__ondisconnected",connected:"__connected",resolved:"__resolved",started:"__started",element:"__element",webcomponents:"__define",attributes:"__attributes",listeners:{value:"__listeners",branch:"__branch",bind:"__bind",trigger:"__trigger",format:"__format"},trigger:"__trigger",compose:"__compose",apply:"__apply",uri:"src",reference:"ref",childPosition:"__childposition",attribute:"escomponent",options:"__options",source:"__source",path:"__path",animate:"__animate",states:"__states",editor:"__editor",original:"__original",resize:"__onresize"};var ut=(e,t)=>e in t,_o=(e,t,o)=>{let n=t[e[0]];if(n){let r=n[e.slice(1).join(o)];if(r)return r}},fe=(e,t,o={})=>{let n=o.fallbacks??[],r=o.keySeparator??j;if(o.shortcuts){let p=_o(t,o.shortcuts,r);if(p)return o.output==="info"?{value:p,exists:!0,shortcut:!0}:p}typeof t=="string"?t=t.split(r).flat():typeof t=="symbol"&&(t=[t]);let s;t=[...t],t=t.map(p=>typeof p=="string"?p.split(r):p).flat();let i=e,a=[i];for(let p=0;p<t.length;p++)if(i){let c=t[p];s=ut(c,i),s?i=i[c]:(i=void 0,s=!0),a.push(i)}return o.output==="info"?{value:i,exists:s,parent:a[a.length-2]}:i},ue=(e,t,o,n={})=>{let r=n?.create??!1,s=n?.keySeparator??j;typeof e=="string"?e=e.split(s):typeof e=="symbol"&&(e=[e]),e=[...e];let i=[...e],a=i.pop();for(let p=0;p<i.length;p++){let c=i[p],f=ut(c,o);r&&!f&&(o[c]={},f=!0),f&&(o=o[c])}return o[a]=t,!0};var Le={};k(Le,{functions:()=>So,objects:()=>Te});function xo(e,t){let o=this,n=this.target;if(!this.parent){let r=n[e];try{Object.defineProperty(n,e,{get:()=>r,set:function(s){r=s,o.proxy[e]={[I]:this[I],[oe]:!0,value:s}},enumerable:!0,configurable:!0})}catch{console.error(`Could not reassign ${e} to a top-level setter...`)}}t&&this.newKeys.add(e),this.create(e,n,void 0,!0)}var me=xo;var So=function(){let e=this;return{apply:async function(t,o,n){try{let r=t;n[0]?.[oe]&&(r=n[0].value,n=n.slice(1));let i=e.listeners.functions,a=e.path.join(e.options.keySeparator),p=i?i[a]:void 0,c,f={};p?(f=de(o,p,r,n),c=f.output):(c=r.apply(o,n),f=e?.state?.[a]?.value??{});let u=e.options.callback;return N(u,a,f,c),c}catch(r){console.warn("Function failed:",r,e.path)}}}},Te=function(){let e=this;return{get(t,o,n){return o===I?!0:Reflect.get(t,o,n)},set(t,o,n,r){if(o===I)return!0;let s=[...e.path,o].join(e.options.keySeparator),i=n?.[I],a=n?.[oe];a&&(n=n.value);let p=e.listeners.setters,c=Object.getOwnPropertyDescriptor(t,o);if(c&&!c.get&&!c.set&&typeof e.options.globalCallback=="function"){let d=e.path[0];me.call(e,o,!0),Fe("setters",s,n,e.options.globalCallback,{[d]:e.root},e.listeners,e.options)}if(n||typeof n=="function"){let d=e.create(o,t,n);d&&(n=d)}let u=!i;if(p&&u&&!e.newKeys.has(o)){let d=p[s];d&&he(d,n)}let y=e.options.callback,v=e?.state?.[s]?.value??{};return N(y,s,v,n),a||!u?!0:Reflect.set(t,o,n,r)}}};var A=typeof process=="object";var vo=(e,t,o)=>{try{o===void 0&&(o=e[t])}catch(c){return c}if(e[t]&&e[t][I])return!1;let r=typeof o,s=r==="object",i=r=="function";if(!o||!(s||i)||!A&&o instanceof Element||o instanceof EventTarget)return!1;let p=s&&W(o);if(i)return!0;{let c=Object.getOwnPropertyDescriptor(e,t);if(c&&(c.value&&c.writable||c.set)){if(!p)return!0}else if(!e.hasOwnProperty(t))return!0}return!1},D=class{constructor(t={},o={},n,r){this.path=[];this.listeners={};this.newKeys=new Set;this.state={};this.set=(t,o,n)=>{this.state[t]={output:n,value:o},ue(t,n,this.proxy,{create:!0})};this.check=vo;this.create=(t,o,n,r=!1)=>{let s=this.check(o,t,n);if(n===void 0&&(n=o[t]),s&&!(s instanceof Error))return o[t]=new D(n,this.options,t,this),o[t];if(r)try{this.proxy[t]=n??o[t]}catch(i){let a=W(o),p=[...this.path,t];console.error(`Could not set value (${p.join(this.options.keySeparator)})${a?" because the parent is an ESM.":""}`,a?"":i)}};if(o.pathFormat||(o.pathFormat="relative"),o.keySeparator||(o.keySeparator=j),t.__proxy)this.proxy=t.__proxy;else if(t[I])this.proxy=t;else{this.target=t,this.options=o,this.parent=r,this.parent?(this.root=this.parent.root,this.path=[...this.parent.path],this.state=this.parent.state??{}):this.root=t,n&&this.path.push(n),this.options.listeners&&(this.listeners=this.options.listeners),this.options.path&&(this.options.path instanceof Function?this.path=this.options.path(this.path):Array.isArray(this.options.path)?this.path=this.options.path:console.log("Invalid path",this.options.path)),this.path&&(this.path=this.path.filter(a=>typeof a=="string")),this.options.keySeparator||(this.options.keySeparator=j);let s=this.options.type;s!="object"&&(s=typeof t=="function"?"function":"object");let i=Le[`${s}s`].call(this);s==="function"&&(i={...i,...Te.call(this)}),this.proxy=new Proxy(t,i),Object.defineProperty(t,"__proxy",{value:this.proxy,enumerable:!1}),Object.defineProperty(t,"__esInspectable",{value:this,enumerable:!1});for(let a in t)me.call(this,a)}return this.proxy}};var ye=(e,t,o,n)=>{let r=n.reference,s=Array.isArray(e)?e[0]:typeof e=="string"?e.split(o.keySeparator)[0]:e,i=n.hasOwnProperty("static")?!n.static:!1;i&&!globalThis.Proxy&&(i=!1,console.warn("Falling back to using function interception and setters...")),i&&(t=new D(t,{pathFormat:o.pathFormat,keySeparator:o.keySeparator,listeners:n.listeners,path:p=>p.filter(c=>!o.fallbacks||!o.fallbacks.includes(c))},s));let a={keySeparator:o.keySeparator,...n};return ue(e,t,r,a),t};var be=(e,t,o,n,r,s,i,a={})=>{typeof o=="string"&&(o=o.split(i.keySeparator));let p=o.join(i.keySeparator),c=r,f=a.ref,u=a.path,y=h=>fe(f??r,h,{keySeparator:i.keySeparator,fallbacks:i.fallbacks}),v=(h,g)=>{ye(h,g,i,{reference:f??r,listeners:s})},d=i.onUpdate,x={};d&&typeof d=="object"&&d.callback instanceof Function&&(x=d.info??{},d=d.callback);let b=[e,...o],_={absolute:b,relative:p.split(i.keySeparator),parent:b.slice(0,-1)};_.output=_[i.pathFormat];let m={id:e,path:_,keySeparator:i.keySeparator,infoToOutput:x,callback:(...h)=>{let g=t(...h);return d instanceof Function&&d(...h),g},get current(){return y(u??m.path.absolute)},set current(h){v(u??m.path.absolute,h)},get parent(){return y(u?u?.slice(0,-1):m.path.parent)},get reference(){return c[e]},set reference(h){c[e]=h},original:n,history:typeof n=="object"?Object.assign({},n):n,sub:Symbol("subscription"),last:o.slice(-1)[0]};return m},mt=(e,t,o)=>{if(o){let n=Math.random();o.symbol[t]={name:e,id:n},o.name[e]||(o.name[e]={}),o.name[e][n]=t}},ht=(e,t,o)=>{let n=C("absolute",e);return t[n]||(t[n]={}),t[n][e.sub]=e,mt(n,e.sub,o),!0},Ge={functions:yt,setters:Me},Fe=(e,t,o,n,r,s,i)=>{let{id:a,path:p}=pe(t,i),c=be(a,n,p,o,r,Ge,i);if(Ge[e])Ge[e](c,s,s.lookup);else{let f=C("absolute",c);s[e][f][c.sub]=c,s.lookup&&mt(f,c.sub,s.lookup)}},Po=(e,t)=>t[C("absolute",e)],dt=(e,t,o,n)=>{let r=!!Po(e,t);if(!r){let s=e.parent,i=s?.[e.last];r=o(i,s)}return ht(e,t,n)},he=(e,t)=>B(e,(o,n)=>{let r=C("output",n);N(n.callback,r,{},t)});function Me(e,t,o){let n=this;return dt(e,t.setters,(r,s)=>{let i=r;if(!!s&&!s[I]){let a=!0;try{delete s[e.last]}catch{console.error("Unable to redeclare setters. May already be a dynamic object..."),a=!1}if(a){let p=e.last.slice(0,2)==="__"||e.last==="default";try{Object.defineProperty(s,e.last,{get:()=>i,set:async c=>{let f=typeof i=="function";if(i=c,f)i=Re.call(n,e,t,i);else{let u=Object.assign({},t.setters[C("absolute",e)]);he(u,c)}},enumerable:!p,configurable:!0})}catch(c){throw c}}}},o)}function Re(e,t,o){return function(...n){let r=t.functions[C("absolute",e)];return de(this,r,o??e.original,n).output}}var de=(e,t,o,n)=>{t=Object.assign({},t);let r=Object.getOwnPropertySymbols(t),s=t[r[0]]??{},i=ft((...a)=>o.call(e,...a),n,s.infoToOutput);return B(t,(a,p)=>{let c=C("output",p);N(p.callback,c,i.value,i.output)}),i};function yt(e,t,o){return dt(e,t.functions,(n,r)=>{if(!r[I])return r[e.last]=Re.call(this,e,t),Me(e,t,o)},o)}var M=Symbol("abort"),bt=(e,t=[])=>({typeof:typeof e,name:e?.constructor?.name,simple:!0,object:e&&typeof e=="object",path:t}),q=(e,t,o={})=>{let n=o.accumulator;n||(n=o.accumulator={});let r=o.ignore||[],s=o.path||[],i=o.condition||!0,a=[],p=[],c=(f,u={},y)=>{let v=y.path;if(v.length===0&&!(i instanceof Function?i(void 0,f,{...bt(f,v)}):i))return f;for(let d in f){if(o.abort)return;if(r.includes(d))continue;let x=f[d],b=[...v,d],_=bt(x,b);if(_.object){let S=_.name;if(W(x)||S==="Object"||S==="Array"){_.simple=!0;let h=a.indexOf(x);if(h!==-1)u[d]=p[h];else{a.push(x);let g=i instanceof Function?i(d,x,_):i;_.pass=g;let P=t(d,x,_);if(P===M)return M;if(u[d]=P,g){p.push(u[d]);let w=c(x,u[d],{...y,path:b});if(w===M)return M;u[d]=w}}}else{_.simple=!1;let h=t(d,x,_);if(h===M)return M;u[d]=h}}else{let S=t(d,x,_);if(S===M)return M;u[d]=S}}return u};return c(e,n,{path:s})};var gt=()=>({symbol:{},name:{}}),wo=typeof process=="object",re=class{constructor(t={}){this.poller=new te;this.options={pathFormat:"relative",keySeparator:j};this.listeners={polling:this.poller.listeners,functions:{},setters:{},lookup:gt()};this.references={};this.get=(t,o,n=this.references)=>fe(n,t,{keySeparator:this.options.keySeparator,fallbacks:this.options.fallbacks,output:o});this.set=(t,o,n={})=>{let r={...n};return r.reference||(r.reference=this.references),r.listeners||(r.listeners=this.listeners),ye(t,o,this.options,r)};this.on=(t,o)=>{let n=pe(t,this.options);return this.listen(n.id,o,n.path)};this.getInfo=(t,o,n,r)=>{let s=be(t,o,n,r,this.references,this.listeners,this.options),i=Math.random(),a=this.listeners.lookup,p=C("absolute",s);return a.symbol[s.sub]={name:p,id:i},a.name[p]||(a.name[p]={}),a.name[p][i]=s.sub,s};this.listen=(t,o,n=[],r={})=>{typeof n=="string"?n=n.split(this.options.keySeparator):typeof n=="symbol"&&(n=[n]);let s=n,i=this.get(t);if(!i){console.error("Reference does not exist.",t);return}r.poll||(r.poll=W(i)),r.seen||(r.seen=[]);let a=r,p=[t,...s],c=this.get(p),f=(x,b=!1)=>!(x&&typeof x=="object")||!wo&&x instanceof Element?!1:b?!0:!Array.isArray(x),u={},y=!1;f(c,!0)&&(c.__esInspectable&&(c.__esInspectable.options.globalCallback=o),q(c,(x,b,_)=>{if(!_.pass){let S=[...s,..._.path],m=this.listen(t,o,S,a);Object.assign(u,m)}},{condition:(x,b)=>f(b)}),y=!0);let d;try{if(d=this.getInfo(t,o,s,c),d&&!y)if(a.poll)y=this.poller.add(d);else{let x="setters";typeof c=="function"&&(x="functions"),y=this.add(x,d)}}catch(x){console.error("Fallback to polling:",n,x),y=this.poller.add(d)}if(y){if(u[C("absolute",d)]=d.sub,this.options.onInit instanceof Function){let x={};for(let b in d.infoToOutput)x[b]=void 0;this.options.onInit(C("output",d),x)}return u}else{console.error("Failed to subscribe to:",n);return}};this.add=(t,o)=>ne[t]?ne[t](o,this.listeners,this.listeners.lookup):(this.listeners[t][C("absolute",o)][o.sub]=o,!0);this.remove=t=>{t||(t={...this.listeners.functions,...this.listeners.setters,...this.listeners.polling}),typeof t!="object"&&(t={sub:t});for(let o in t){let n=t[o],r=s=>{this.unsubscribe(s)===!1&&console.warn(`Subscription for ${o} does not exist.`,s)};typeof n!="symbol"?B(n,r):r(n)}return!0};this.unsubscribe=t=>{let o=this.listeners.lookup.symbol[t],n=o.name,r=this.poller.get(t),s=this.listeners.functions[n],i=s?.[t],a=this.listeners.setters[n],p=a?.[t];if(r)this.poller.remove(t);else if(i)delete s[t],Object.getOwnPropertySymbols(s).length||(Object.defineProperty(i.parent,i.last,{value:i.original,writable:!0}),delete this.listeners.functions[n]);else if(p){if(delete a[t],!Object.getOwnPropertySymbols(a).length){let f=p.parent;if(f){let u=p.last,y=f[u];Object.defineProperty(f,u,{value:y,writable:!0})}delete this.listeners.setters[n]}}else return!1;delete this.listeners.lookup.symbol[t];let c=this.listeners.lookup.name[o.name];delete c[o.id],Object.getOwnPropertyNames(c).length||delete this.listeners.lookup.name[o.name]};Object.defineProperty(this.listeners,"lookup",{value:gt(),enumerable:!1,configurable:!1}),Object.assign(this.options,t),this.poller.setOptions(t.polling)}};var se=re;var Ne={},_t=["Object","Array","Map","Set"];function T(e){var t=[];if(e)do{let o=e.constructor?.name,n=_t.includes(o);_t.includes(o)&&(Ne[o]||(Ne[o]=[...Object.getOwnPropertyNames(globalThis[o].prototype)])),Object.getOwnPropertyNames(e).forEach(function(r){n&&Ne[o].includes(r)||t.indexOf(r)===-1&&t.push(r)})}while(e=Object.getPrototypeOf(e));return t}var Ke=(e,t={})=>{if(typeof e=="object")if(Array.isArray(e))e=[...e],t.accumulator=[];else{let o=T(e),n={};for(let r of o)n[r]=e[r];e=n,t.accumulator={}}return e},L=(e,t={})=>typeof e!="object"?e:(e=Ke(e,t),q(e,(o,n,r)=>r.simple&&r.object?Array.isArray(n)?[]:{}:n,t),t.accumulator);var xt=e=>typeof e=="object"&&typeof e.then=="function",E=(e,t)=>(typeof e=="object"&&Array.isArray(e)&&e.find(o=>xt(o))&&(e=Promise.all(e)),xt(e)?new Promise(o=>{e.then(async n=>{let r=t?t(n):n;o(r)})}):t?t(e):e),St=[],J=(e,t,o=!1,n=!1,r=!1,s=[])=>{let i=o?e:Ke(e);if(n&&([i,t]=[t,i]),t){let a=T(i),p=new Set(T(t));a.forEach(c=>{p.delete(c);let f=c in t,u=t[c];if(f&&u===void 0)delete i[c];else if(typeof u=="object"&&!Array.isArray(u))if(typeof i[c]=="object"){let y=i[c],v=s.indexOf(y);v!==-1?i[c]=s[v]:(s.push(y),i[c]=J(y,u,o,!1,r,s))}else i[c]=u;else if(typeof u=="function"){let y=i[c],v=typeof y=="function",d=u,x=d.__compose===!0;if(!v||!r&&!x)i[c]=d;else{let b=St.find(S=>S.f===y),_=y;if(b||(_.__esInspectable&&(_=_.__esInspectable.target),b={f:_,list:[_]},St.push(b)),b.list.includes(d))console.warn("This function was already composed. Ignoring duplicate.");else{let S=i[c]=function(...m){let h=_.call(this,...m);return d.call(this,...Array.isArray(h)?h:[h])};b.f=S,b.list.push(d)}}}else c in t&&(i[c]=u)}),p.forEach(c=>{let f=t[c];f!==void 0&&(i[c]=f)})}return i};function V(e){return Eo(e)==="class"}function Eo(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype").writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var ze={};k(ze,{behavior:()=>Ao,default:()=>$e,name:()=>jo,properties:()=>To});var ko=async(e,t)=>{let o=await fetch(e).then(n=>n.arrayBuffer());return WebAssembly.instantiate(o,t)},Co=async(e,t)=>(t||(t={env:{abort:()=>console.log("Abort!")}}),WebAssembly.instantiateStreaming?await WebAssembly.instantiateStreaming(fetch(e),t):await ko(e,t)),vt=Co;var Pt=(e,t)=>e[l.reference]?(console.warn("[escode]: Falling back to ES Component reference...",t),e[l.reference]):Io(t.message),wt=`Cannot transform ${l.compose} string without a compose utility function`;function ge(e,t){let o=typeof e=="string"?e:e[l.uri];if(o&&o.slice(-5)===".wasm"){let n=e.relativeTo??t?.relativeTo??window.location.href;n.slice(-1)[0]!=="/"&&(n+="/");let r=new URL(o,n).href;return new Promise(async s=>{let i=await vt(r,e.importOptions),a=Object.assign({},i.instance.exports);for(let p in a){let c=a[p];c instanceof WebAssembly.Memory?a[p]=new Uint8Array(c.buffer):c instanceof WebAssembly.Global&&Object.defineProperty(a,p,{get:()=>c.value,set:f=>c.value=f})}s(a)})}else if(o&&t.utilities){let n=t.utilities.bundle,r=n&&typeof n.function=="function",s=t.utilities.compile,i=s&&typeof s.function=="function";if(!r&&!i)e=Pt(e,new Error(wt));else return new Promise(async a=>{try{if(r){let p=n.options??{};p.bundler||(p.bundler="datauri"),p.bundle||(p.collection="global"),p.relativeTo||(p.relativeTo=t.relativeTo??".");let c=n.function(o,p);await c.compile(),e=Object.assign({},c.result)}else if(i){let p=s.options??{};p.relativeTo||(p.relativeTo=t.relativeTo??"."),e=await s.function(e,p)}else throw new Error(wt)}catch(p){e=Pt(e,p)}a(L(e))})}return L(e[l.reference]??e)}function Io(e){return{[l.element]:"p",b:{[l.element]:"b",[l.attributes]:{innerText:"Error: "}},span:{[l.element]:"span",[l.attributes]:{innerText:e}}}}var jo="compose",Y={compose:l.compose,apply:l.apply,bundle:H},Ao="load",To={dependents:Object.values(Y)},Lo=e=>typeof e=="string"&&(e.includes("/")||e.includes("."));function Fo(e,t,o,n=!1){return e=J(e,t,n),e=Et(e,e[Y.compose],o,!0,n),E(e,r=>{let s=r[Y.apply];return r=s&&(typeof s=="object"||Lo(s))?Et(r,s,o,!1,n):r,E(r)})}var $e=Fo;function Et(e,t={},o={},n=!1,r=!1){Array.isArray(t)||(t=[t]);let s=E(t.map(i=>{let a=ge(i,o),p=(c,f=[],u=!0)=>{if(Array.isArray(c))c.forEach(y=>p(y,f),!0);else if(c[Y.compose]){f.push(c);let y=c[Y.compose];delete c[Y.compose];let v=E(ge(y,o));p(v,f)}else u&&f.push(c);return f};return E(a,c=>p(c))}));return E(s,i=>{let a=i.flat(),p={};return a.forEach(c=>p=J(p,c,!1,!1)),J(e,p,r,n)})}var ie=Symbol("return");var Go=e=>typeof e=="function"&&e.hasOwnProperty("prototype")&&!e.hasOwnProperty("arguments");function We(e,t={},o={}){if(A||e instanceof NodeList&&(e=Array.from(e)),typeof e=="string")e={[l.apply]:e};else if(typeof e=="function")Go(e)?e=new e(t,o):(delete e.__,e={[l.default]:e});else if(!A&&e instanceof Element){let n=e[l.component];if(n){t=L(t);let r=t.__compose,s=t.__apply;return delete t.__compose,delete t.__apply,r&&(console.warn("Cannot compose a component onto an element that already has a component. Merging with the base object instead..."),t=Object.assign(r,t)),s&&(console.warn("Cannot apply a component onto an element that already has a component. Applying to the base object instead..."),t=Object.assign(t,s)),$e(n,t,o,!0),{[ie]:n}}else e={[l.element]:e}}else{if(Array.isArray(e))return e;if(typeof e=="object")e=o.clone!==!1?L(e):e;else throw new Error(`Invalid configuration type: ${typeof e}. Expected object or string.`)}return e}var Ot=e=>{let t=L(e),o;return t.monitor instanceof se?(o=t.monitor,t.keySeparator=o.keySeparator):(t.monitor||(t.monitor={}),t.monitor.keySeparator||(t.keySeparator||(t.keySeparator=j),t.monitor.keySeparator=t.keySeparator),t.monitor=new se(t.monitor)),t};globalThis.escomposePerformance={create:[],resolve:[],resolveAll:[],listeners:{create:[],resolve:[]},averages:function(){let e={create:0,resolve:0,resolveAll:0,listeners:{create:0,resolve:0}};for(let t in e)if(typeof this[t]=="object"&&!Array.isArray(this[t]))for(let o in this[t])e[t][o]=this[t][o].reduce((n,r)=>n+r,0)/this[t][o].length;else e[t]=this[t].reduce((o,n)=>o+n,0)/this[t].length;return e}};var kt="default",Ct="__operator",F={path:"__path",isGraphScript:"__",listeners:{value:"__listeners",branch:"__branch",bind:"__bind",trigger:"__trigger",format:"__format"}},It=Symbol("listenerObject"),jt=Symbol("toSet"),ae=Symbol("subscriptionKey"),At=Symbol("configKey"),Be=Symbol("toResolveWithKey"),Mo=e=>F.listeners.format in e||F.listeners.branch in e||F.listeners.trigger in e||F.listeners.bind in e,Tt="INITIALIZED",Lt="REGISTERED",Ro={},No={},Ko={},De=class{constructor(t,o,n){this.original={};this.active={};this.globals={};this.context={options:{}};this.rootPath="";this.status="";this.#e=[];this.#t=[];this.setInitialProperties=(t={},o,n={})=>{Object.assign(this.context,n),o&&(this.rootPath=o),this.context.options.keySeparator||(this.context.options.keySeparator=this.context.monitor.options.keySeparator),this.original=t,[{name:"active",ref:Ko},{name:"from",ref:Ro},{name:"to",ref:No}].forEach(s=>{s.ref[this.context.id]||(s.ref[this.context.id]={}),this.globals[s.name]=s.ref[this.context.id]}),this.#n=this.getManager(),this.runEachListener(t,this.addToGlobalLog)};this.getManager=(t="from")=>{let o=t==="to"?this.globals.to:this.globals.from;return this.rootPath.split(this.context.options.keySeparator).forEach(n=>{o[n]||(o[n]={}),o=o[n]}),o[Be]??this};this.onStart=t=>{let o=this.#n;o===this?this.status===Tt?t():this.#t.push(t):o.onStart(t)};this.runEachListener=(t,o)=>{if(!!o)for(let n in t){let r=t[n];if(!r){console.warn("Skipping empty listener:",n);continue}if(r&&typeof r=="object"){let s=r,i=n;for(let a in s)o(a,i,s[a])}else{let s=n,i=r,a=typeof i;a==="function"?o(s,"",i):a==="string"?o(s,i,i):console.error("Improperly Formatted Listener",i)}}};this.register=(t=this.original)=>{this.runEachListener(t,this.add),this.status=Lt};this.#s=t=>{let o=this.context.monitor.get(t.path,"info");if(typeof o.value=="function"){let n=Array.isArray(t.args)?t.args:[t.args];o.value(...n)}else console.error("Cannot yet trigger values...",t)};this.initialize=t=>{this.status?this.status===Lt?(this.status=Tt,this.#e.forEach(this.#s),this.#t.forEach(o=>o()),this.#t=[],this.#e=[]):this.#s(t):this.#e.push(t)};this.start=()=>{this.register(),this.initialize()};this.#r=t=>{let o=this.context.monitor.options.keySeparator;return!t||!this.rootPath||this.rootPath===t.slice(0,this.rootPath.length)&&t[this.rootPath.length]===o?t:[this.rootPath,t].join(o)};this.#o=t=>{let o={absolute:{},relative:{}};t=this.#r(t);let n=this.rootPath?t.replace(`${this.rootPath}.`,""):t,r=t.split(this.context.options.keySeparator);o.absolute.array=[this.context.id,...r],o.relative.array=n.split(this.context.options.keySeparator);let s=this.context.monitor.get(o.absolute.array,void 0);if(this.context.graph){if(s&&this.context.bound)o.absolute.array=[this.context.id,this.context.bound,...o.absolute.array.slice(1)],o.relative.array.unshift(this.context.bound);else if(!s){let f=o.relative.array.join(this.context.options.keySeparator);s=this.context.graph.get(f)}}let i=s&&typeof s=="object"&&F.isGraphScript in s,a=s&&i&&s[Ct],p=s&&s[kt],c=a?Ct:p?kt:void 0;return c&&(o.absolute.array.push(c),o.relative.array.push(c)),o.absolute.value=o.absolute.array.slice(1).join(this.context.options.keySeparator),o.relative.value=o.relative.array.join(this.context.options.keySeparator),o};this.add=(t,o,n=!0,r)=>{let s=performance.now();if(!n)return;let i=this.#o(t),a=this.#o(o),p=i.absolute.value;r||(r=this.globals.active[p]?.[ae]),r||(r=this.context.monitor.on(i.absolute.array,(v,d,x)=>this.activate(v,x),{ref:this.context.instance,path:i.relative.array})),typeof n=="string"&&(n=a.absolute.array.slice(1).join(this.context.options.keySeparator));let c={value:n,[It]:!0};[this.active,this.globals.active].forEach(v=>{v[p]||(v[p]={});let d=v[p];d[ae]||Object.defineProperty(d,ae,{value:r,configurable:!0}),d[a.absolute.value]=c});let u=n[F.listeners.trigger];u&&this.#n.initialize({path:i.absolute.array,args:u}),this.addToGlobalLog(p);let y=performance.now();return globalThis.escomposePerformance.listeners.create.push(y-s),c};this.addToGlobalLog=(t,o="from")=>{let n=this.#r(t),r=o==="to"?this.globals.to:this.globals.from;n.split(this.context.options.keySeparator).forEach(i=>{r[i]||(r[i]={}),r=r[i],r[Be]||(r[Be]=this)})};this.remove=(t,o)=>{let n=this.#o(t),r=this.#o(o),s=[n.absolute.value,r.absolute.value];[{ref:this.active,path:s},{ref:this.globals.active,path:s,unlisten:!0}].forEach(a=>{let{ref:p,path:c,unlisten:f}=a,u=p[c[0]];if(typeof u=="object"){if(delete u[c[1]],Object.keys(u).length===0){delete p[c[0]];let y=u[ae];f&&y&&this.context.monitor.remove(y),delete u[ae]}}else delete p[c[0]]})};this.clear=t=>{let o=this.#r(t);Object.keys(this.active).forEach(n=>{Object.keys(this.active[n]).forEach(r=>{(!o||n.slice(0,o.length)===o||r.slice(0,o.length)===o)&&this.remove(n,r)})})};this.has=(t,o=this.active)=>!!o[t];this.get=(t,o=this.active)=>o[t];this.activate=(t,o)=>{this.context.options.listen?.(t,o),[{info:this.get(t,this.globals.active),name:t}].forEach(r=>{let s=r.info;if(s)if(s[It]){let i=performance.now();this.pass(t,{value:s.value,parent:this.active,key:r.name,subscription:s.subscription,__value:!0},o);let a=performance.now();globalThis.escomposePerformance.listeners.resolve.push(a-i)}else if(typeof s=="object"){let i=performance.now();for(let a in s){this.pass(t,{parent:s,key:a,subscription:s[a].subscription,value:s[a].value},o);let p=performance.now();globalThis.escomposePerformance.listeners.resolve.push(p-i)}}else console.error("Improperly Formatted Listener",s)})};this.pass=(t,o,n)=>{let r=this.context.id,s=o?.__value,i=o.parent,a=o.key,p=o.parent[a];o=p.value;let c=p?.[At],f=o,u=typeof o,y=(b,_)=>{let S=this.context.monitor.get(b,"info");if(S.exists){let m=S.value,P={value:typeof m!="function"&&!m?.default?jt:m,bound:S.parent};return _&&(o=P.value,i[a]=P),P}else return{value:void 0}},v=b=>{let _=[r];return _.push(...a.split(this.context.options.keySeparator)),y(_,b)},d=b=>{let _=[r],S=[];return this.rootPath&&S.push(...this.rootPath.split(this.context.options.keySeparator)),S.push(...b.split(this.context.options.keySeparator)),_.push(...S),_};if(typeof o=="boolean")s?console.error(`Cannot use a boolean for ${F.listeners.value}...`):v(!0);else if(u==="string"){let b=d(f);y(b,!0),s&&(i[a]={[f]:i[a]},a=f)}else o&&u==="object"&&Mo(f)&&("value"in f?s?o=i[a]=f.value:o=i[a].value=f.value:v(!0),f&&f&&(c=f),Object.defineProperty(i[a],At,{value:c}));let x=!0;if(c){let b=F.listeners.value;if(b in c){let _=d(c[b].original??c[b]);if(typeof c[b]=="string"){let S=this.context.monitor.get(_);S?c[b]={value:S,original:c[b]}:o=`because ${_.slice(1).join(this.context.options.keySeparator)} does not point correctly to an existing component.`}else c[b].value.__parent||(o=`because ${c[b].original??r.toString()} has become unparented.`)}else{let _=F.listeners.branch,S=F.listeners.format;if(_ in c&&(c[_].find(h=>{let g=[];"if"in h&&g.push(h.if(n)),"is"in h&&g.push(h.is===n);let P=g.length>0&&g.reduce((w,O)=>w&&O,!0);return P&&"value"in h&&(n=h.value),P})||(x=!1)),S in c)try{n=c[S](n),n===void 0&&(x=!1)}catch(m){console.error("Failed to format arguments",m)}}}if(x&&n!==void 0){let b=Array.isArray(n)?n:[n];if(o===jt){let _=[r];_.push(...a.split(this.context.options.keySeparator));let S=_.pop(),m=this.context.monitor.get(_,"info");m.value?m.value[S]=n:console.error(`Cannot set value on ${_.filter(h=>typeof h!="symbol").join(this.context.options.keySeparator)} from ${t}`)}else if(o?.default)o.default.call(o,...b);else if(typeof o=="function"){let _=c?.[F.listeners.bind]?.value??p.bound??this.context.instance;_?o.call(_,...b):o(...b)}else{let _=a?`listener: ${t} \u2014> ${a}`:`listener from ${t}`;i?(console.warn(`Deleting ${_}`,o),delete i[a]):console.error(`Failed to add ${_}`,o)}}};(t||o||n)&&this.setInitialProperties(t,o,n)}#e;#t;#n;#s;#r;#o},Ft=De;var _e=e=>e.includes(l.isGraphScript)||e==="default",$o=["Object","Array"],zo=e=>{let t=!1;return q(e,(o,n,r)=>{if(r.path.length>1&&!r.path.find(i=>i==="__")&&_e(o))return t=r.path,M},{ignore:["__","__parent","__compose","__apply"],condition:(o,n)=>{let r=n?.constructor?.name,s=n?.__props?.constructor?.name;return!(!$o.includes(r)&&!!globalThis[r]||!!globalThis[s])}}),t};function Ue(e){if(!e||typeof e!="object")return null;let t=Object.entries(e).map(([n,r])=>{if(!(r&&typeof r=="object"||typeof r=="function"))return;if(n.includes(l.isGraphScript)?!1:Object.keys(r).find(_e))return n==="constructor"&&V(r)?void 0:{ref:r,parent:e,name:n}}).filter(n=>n&&n.ref),o=t.length>0;if(!o){let n=zo(e);if(n){let r=n.slice(0,-2),s=e;r.forEach(a=>{s=s[a],s.__=!0});let i=n[0];t=[{ref:e[i],parent:e,name:i}],o=!0}}return o?t:null}var He={};k(He,{default:()=>Ho,name:()=>Wo,properties:()=>Do,required:()=>Bo});var Wo="props",Bo=!0,Do={dependents:["__props"]},Mt,Rt=(e,t,o,n=t)=>{o||(o=T(t)),o.forEach(r=>{if(!(r in e)){let s={get:()=>n[r],set:i=>{n[r]=i},enumerable:!0,configurable:!1};n!==t&&Object.defineProperty(n,r,s),Object.defineProperty(e,r,s)}})},Uo=e=>{let t=e.__props,o;return Object.defineProperty(e,"__props",{get:()=>o,set:n=>{if(typeof n!="object"&&!V(n))console.warn("Props must be an object");else{let r=T(n);if(!o)o=n,Mt=r;else{let s=o;o={},Rt(o,s,Mt)}Rt(e,n,r,o)}},enumerable:!1,configurable:!1}),t&&(e.__props=t),e},Ho=Uo;var Je={};k(Je,{default:()=>Zo,name:()=>Jo,properties:()=>Yo,required:()=>Vo});var Wr={dependencies:[l.isGraphScript,l.parent],dependents:[]},qo=(e,t,o={})=>{let n=e[l.isGraphScript],r=e[l.parent],s=n.name;r=(!A&&r instanceof Element?r?.[l.component]:r)??e[l.parent];let i={value:"",writable:!0};if(r&&r[l.isGraphScript]&&typeof s=="string"){let p=r,c=[];for(;p&&p[l.isGraphScript];){let f=p[l.isGraphScript].name;if(typeof f=="string")c.push(f);else{typeof f=="symbol"?n.root=f:console.error("No graph reset occured for",f);break}p=p[l.parent]}i.value=[...c.reverse(),s],i.value=i.value.join(o.keySeparator??".")}Object.defineProperty(n,"path",i)},qe=qo;var Jo="parent",Vo=!0,Yo={dependencies:[l.isGraphScript],dependents:[]},Xo=(e,t,o)=>{let n=e[l.isGraphScript];n.parent={callbacks:[],add:function(i){this.callbacks.push(i)},get:()=>s,start:(i=!1)=>{if(i||s[l.isGraphScript]?.start?.value===!0){let a=n.connected,p=a instanceof Function;e[l.isGraphScript].start.run(),p&&a()}}};let s=e[l.parent]??t[l.parent];Object.defineProperty(e,l.parent,{get:()=>n.parent.get(),set:i=>{let a=s&&!i;if(s?.[l.isGraphScript]){let c=n.name;delete s[c],s.__.components.delete(c)}if(s=i,s?.[l.isGraphScript]){let c=n.name;s[c]&&console.error("OVERWRITING EXISTING PROPERTY ON PARENT!"),s[c]=e,s.__.components.set(c,e)}n.parent.callbacks.forEach(c=>c.call(e,i)),qe(e,void 0,o),a?e[l.isGraphScript].stop.run():s&&n.parent.start()}}),qe(e,void 0,o)},Zo=Xo;var Nt=(e,t,o,n)=>E(n,()=>e.call(t,...o)),Kt=(e,t=[],o)=>{if(e.length)if(e.length===1)Nt(e[0],o,t);else return e.reduce((n,r)=>Nt(r,o,t,n))},Qo=(e,t,o=[],n)=>e.reduce((r,s)=>E(r,i=>{let p=(typeof s=="function"?s:s.default)(i,...o);return n&&n(p)?i:p}),t),xe=(e,t,o)=>{let{main:n,overrides:r,options:s}=t,i;if(!Array.isArray(e)){if(!e[o])return n;let c=e;switch(e=c[o]??[],o){case"activate":i=[...c.load??[]];break;case"start":i=[...c.load??[],...c.activate??[]];case"stop":i=[...c.load??[],...c.activate??[],...c.start??[]];break}}let p=tn(n,e,i);return p?Qo(p,n,[r,s],c=>!c||typeof c!="object"):n},en=e=>{let t={};return e.forEach(o=>{let n=typeof o=="function"?"activate":o.behavior??"activate";(t[n]=t[n]??[]).push(o)}),t},tn=(e,t,o=[])=>{let n=T(e).filter(a=>a.slice(0,2)==="__"),s=[...Object.values(je),...o.map(a=>typeof a=="function"?[]:a.properties.dependents).flat()];return t.filter(a=>{if(a&&typeof a=="object"){let p=a.name,{dependencies:c,dependents:f=[]}=a.properties,u=a.required||!c;if(!u&&c){let y=p?` (${p})`:"";if(f.find(d=>n.includes(d))){let d={};c.forEach(b=>d[b]=s.includes(b));let x=c.filter(b=>!s.includes(b));x.length&&console.warn(`The loader${y} for ${c.join(", ")} might be loaded too early, since we are missing the following dependencies: ${x.join(", ")}`),u=!0}}return u&&f&&s.push(...f),u}})};function $t(e,t="main"){let{callbacks:o}=this;return o[t].push(e),!0}function on(e){let{callbacks:t,name:o}=this;if(!this.value){let n=o==="stop";n&&console.log("Running Stop...",e.__.path);let r=e[l.isGraphScript],s=n?r.stop.initial:e[l[o]];this.value=!0,n||(r.stop.value=!1);let i=s&&!n?[...t.before,s,...t.main]:[...t.before,...t.main],a=Kt(i,[e],e);return E(a,()=>{let p=Array.from(e[l.isGraphScript].components.entries()),c=E(p.map(async([f,u])=>{let y=u[l.promise];return y&&typeof y.then=="function"&&(u=p[f]=await y),await u[l.isGraphScript][o].run()}));return E(c,()=>{let f=Kt(t.after,[e],e);return E(f,()=>{if(n){s&&s.call(e,e),r.flow.clear();let u=e[l.isGraphScript].path,y=e,v=y[l.parent];for(;v&&v[l.isGraphScript]!==void 0;){let d=y[l.parent];if(d){if(y=d,y){let x=y[l.isGraphScript];x&&x.flow.clear(u)}}else break}r.start.value=!1}return!0})})})}}function le(e,t=[],o){let n=performance.now(),r=o.parent,{parentObject:s,toApply:i={},callbacks:a={},opts:p={},name:c=Symbol("root")}=o,f=e;if(e=We(e,i,p),e[ie])return e[ie];if(Array.isArray(e))return E(e.map(b=>le(b,t,o)));e[l.isGraphScript]=nn(c,o,{parent:r,original:f,loaders:t});let u=en(t),y=xe(u,{main:e,overrides:i,options:p},"load"),v=E(y,b=>{let _=!b[l.parent]&&r?{[l.parent]:r}:{},S=xe([Je],{main:b,overrides:_,options:p}),m=xe([He],{main:S}),h=xe(u,{main:m,overrides:i,options:p},"activate");return E(h,g=>{g.__.ref=g,s&&(s[c]=g),typeof c=="symbol"&&a.onRootCreated&&a.onRootCreated(c,g),a.onInstanceCreated&&a.onInstanceCreated(g.__.path,g);let P=g[l.isGraphScript],w=Ue(m),O=w?w.map(R=>{let $=Object.assign({},o),Z=$.name=R.name;delete $.toApply,$.parentObject=R.parent,$.parent=g;let z=R.ref;if(z)if(z.__?.symbol){let Q=z.__.parent;Q&&console.error(`Changing parent of existing component (${z.__.path}) from ${Q.__.path} to ${P.path}`),z.__.name=Z,z.__parent=g}else{let Q=le(z,t,$);Object.defineProperty(R.parent[Z],l.promise,{value:Q,writable:!1});let Yt=E(Q,ot=>(P.components.set(Z,ot),ot));P.components.set(Z,Yt)}else delete R.parent[Z],console.error("No reference found for nested component",R)}):[],G,U=new Promise(R=>G=async()=>{P.resolved=!0,R(!0)});return Object.defineProperty(g,`${l.resolved}`,{value:U}),P.resolved=!1,E(O,()=>rn(g,a,G)),g})}),x=performance.now()-n;return E(v,b=>{if(!Array.isArray(b)){let S=performance.now()-n;E(b.__resolved,()=>{let h=performance.now()-n;globalThis.escomposePerformance.resolve.push(S),globalThis.escomposePerformance.resolveAll.push(h),globalThis.escomposePerformance.create.push(x)})}}),v}function nn(e,t,o={}){let{parent:n,original:r,loaders:s}=o,i=typeof e=="symbol",a=n?.[l.isGraphScript].path,c=(a?[a,e]:typeof e=="string"?[e]:[]).join(t.keySeparator??j),f={name:e,symbol:Symbol("isGraphScript"),root:i?e:n[l.isGraphScript].root,path:c,options:t,original:r,states:{},components:new Map,connected:!1,resolved:!1,flow:new Ft,create:y=>(t.loaders||(t.loaders=s),zt(y,void 0,t)),stop:{name:"stop",value:!1,add:$t,callbacks:{before:[],main:[],after:[]}},start:{name:"start",value:!1,add:$t,callbacks:{before:[],main:[],after:[]}}},u=function(){return on.call(this,f.ref)};return f.start.run=u.bind(f.start),f.stop.run=u.bind(f.stop),f}function rn(e,t,o){let n=e[l.isGraphScript];for(let i in e){let a=e[i];if(typeof a=="function"&&!V(a)){let p=e[l.proxy]??e;e[i]=a.bind(p)}}n.stop.initial=e[l.stop],e[l.stop]=n.stop.run;let r=T(e);for(let i of r)if(_e(i)){let a=Object.getOwnPropertyDescriptor(e,i);a?.enumerable&&Object.defineProperty(e,i,{...a,enumerable:!1})}let s=e[l.parent];e[l.parent]=s,t.onInstanceReady&&t.onInstanceReady(e.__.path,e),o()}var sn=new se,Ve=(e,t={},o={})=>{let n=Ot(o),r={onRootCreated:(a,p)=>n.monitor.set(a,p,n.listeners),onInstanceCreated:(a,p)=>{let c=p[l.listeners.value]??{},f=p[l.isGraphScript].flow;if(f.setInitialProperties(c,a,{id:p[l.isGraphScript].root,monitor:n.monitor,options:n}),p[l.listeners.value]=c,l.trigger in p){Array.isArray(p[l.trigger])||(p[l.trigger]=[]);let u=p[l.trigger];f.onStart(()=>p.default(...u)),delete p[l.trigger]}},onInstanceReady:(a,p)=>p[l.isGraphScript].flow.start()},s=n.loaders,i=le(e,s,{toApply:t,opts:n,callbacks:r,waitForChildren:!1});return E(i,a=>{let p=Array.isArray(a),c=p?a:[a];return c.map(f=>{if(f[l.parent]||f.__.path===""){let u=f[l.isGraphScript];if(u.start.value===!1){let v=u.start.run();return E(v,Wt)}}else return f}),p?c:c[0]})},zt=Ve;var Wt=E,Bt=L;var Xe={};k(Xe,{default:()=>Ut,name:()=>dn,properties:()=>bn,required:()=>yn});var Pe={};k(Pe,{default:()=>pn,define:()=>ve,name:()=>ln,properties:()=>cn});var ln="define",cn={dependents:[l.webcomponents],dependencies:[l.element,l.component,l.parent]},pn=e=>{let t=e[l.webcomponents]??{};for(let o in t){let n=t[o],r=n[l.element];r.name&&r.extends&&ve(r,e,n)}return e},Se={};if(!A){let e=document.createElement;document.createElement=function(t,o){let n=Se[t];return n&&!n.autonomous?e.call(this,n.tag,{is:t}):e.call(this,t,o)}}var fn={li:"LI",ol:"OL",ul:"UL",br:"BR",p:"Paragraph",textarea:"TextArea",a:"Anchor"},Ye=!1,ve=(e,t,o=t)=>{if(Se[e.name])console.log("Already created component...");else{let n=L(o),r=Ye?"":fn[e.extends]??e.extends[0].toUpperCase()+e.extends.slice(1),s=new Function(`

        class ESComponentBase extends HTML${r}Element { 
            #properties;
            constructor(properties={}){
                super()
               this.#properties = properties
            }
        }
        return ESComponentBase;

        `)();class i extends s{constructor(f){super(f);n[l.element]=this,t[l.isGraphScript].create(n)}connectedCallback(){let f=this[l.component],u=f[l.parent];f[l.parent]=u}disconnectedCallback(){console.log("Custom element removed from page.")}adoptedCallback(){console.log("Custom element moved to new page.")}attributeChangedCallback(f,u,y){console.log("Custom element attributes changed.",f,u,y)}}Se[e.name]={class:i,autonomous:Ye,tag:e.extends};let a=Se[e.name].class;Ye?customElements.define(e.name,a):customElements.define(e.name,a,{extends:e.extends})}};var un=(e="svg",t)=>document.createElementNS("http://www.w3.org/2000/svg",e,t);function mn(e){return e?Array.isArray(e)?!e.reduce((o,n)=>o*(we(n)?0:1),!0):we(e):!1}function we(e){if(e.__element||mn(e.__compose))return!0;if(e.__)return hn(e.__.components)}function hn(e){return Array.from(e.values()).find(t=>{if(we(t))return!0})}var Dt=(e,t)=>e[0]==="svg"||t&&t.__element instanceof SVGElement?un(...e):document.createElement(...e),dn="element",yn=!0,bn={dependents:[l.element,l.attributes,l.resize,l.childPosition,l.editor,l.component,l.attribute,l.connected],dependencies:[l.parent,l.isGraphScript,l.proxy]};function Ut(e,t,o={}){let n=e[l.isGraphScript],r=n.states,s=n.name,i=e[l.parent],a=e[l.element],p=e[l.attributes]??{},c;if(!(a instanceof Element)){let h=p&&Object.keys(p).length||we(e)?"div":"span";if(a&&typeof a=="object"&&a.name&&a.extends){let w=a,O=e[l.element];ve(O,e),e[l.element]=a=w.name}a===void 0?a=h:Array.isArray(a)?a=Dt(a,i):typeof a=="object"&&(c=a,c.selectors?a=document.querySelector(c.selectors):c.id?a=document.getElementById(c.id):a=h),typeof a=="string"&&(a=Dt([a],i));let P=Symbol("no input to the default function");e.hasOwnProperty("default")||(e.default=function(w=P){return w!==P&&(this[l.element].innerText=w),this[l.element]})}if(!(a instanceof Element))throw new Error("Element not created for "+s);let f=r||{};f.element=a,f.attributes=p,i instanceof Element?f.parentNode=i:f.parentNode=i?.[l.element]instanceof Element?i[l.element]:a.parentNode,f.onresize=e[l.resize],f.onresizeEventCallback=void 0;let u=f;typeof s!="string"&&(s=`${a.tagName??"element"}${Math.floor(Math.random()*1e15)}`),a.id||(a.id=s);let y;Object.defineProperty(e,`${l.connected}`,{value:new Promise(m=>y=async()=>{n.connected=!0,m(!0)})}),n.connected=y;let v=(m,h)=>m.slice(0,2)==="on"&&typeof h=="function",d=(m,h,g)=>!v(m,h)&&typeof h=="function"?h.call(g):h,x=m=>{if(e[l.element]instanceof Element)for(let h in m)if(h==="style")for(let g in m.style)e[l.element].style[g]=d(h,m.style[g],e);else{let g=m[h];if(v(h,g)){let P=g;e[l.element][h]=(...w)=>{let O=e[l.proxy]??e;return P.call(O??e,...w)}}else{let P=d(h,g,e);e[l.element].setAttribute(h,P);try{e[l.element][h]=P}catch{}}}};Object.defineProperty(e,l.attributes,{get:()=>u.attributes,set:m=>{u.attributes=m,u.attributes&&x(u.attributes)}}),Object.defineProperty(e,l.element,{get:function(){if(u.element instanceof Element)return u.element},set:function(m){if(m instanceof HTMLElement){u.element!==m&&(u.element.insertAdjacentElement("afterend",m),u.element.remove()),u.element=m;let h=e[l.isGraphScript];if(h){let g=h.components;for(let P in g){let w=g[P];w&&w[l.isGraphScript]&&E(w,O=>O[l.parent]=m)}}x(u.attributes)}}});let b=n.parent.get;n.parent.get=()=>{let m=b(),h=e[l.element].parentNode;return h?h.hasAttribute(l.attribute)?h[l.component]:{[l.element]:h}:m},n.parent.add(function(m){if(typeof m=="string"){let g=document.querySelector(m);g?m=g:m=document.getElementById(m)}m?.[l.element]instanceof Element&&(m=m[l.element]);let h=this[l.element].parentNode;if(h!==m)if(this[l.element]instanceof Element){if(h&&this[l.element].remove(),m instanceof Element){let g=this[l.childPosition],P=this[l.element],w=n.editor;w&&(P=w);let O=m.children.length,G=O&&g!==void 0?m.children[g]??m.children[O-1]:void 0;if(G){let $=G[l.component][l.childPosition]<g?"afterend":"beforebegin";G.insertAdjacentElement($,P)}else m.appendChild(P);w&&w.setComponent(this)}}else console.error("No element was created for this Component...",this)});let _=e[l.resize];Object.defineProperty(e,l.resize,{get:function(){return _},set:function(m){u.onresize=m,u.onresizeEventCallback&&window.removeEventListener("resize",u.onresizeEventCallback),u.onresize&&(u.onresizeEventCallback=h=>{if(u.onresize&&e[l.element]instanceof Element){let g=e[l.proxy]??e;return m.call(g,h)}},window.addEventListener("resize",u.onresizeEventCallback))}});let S=o?.utilities;if(S&&e[l.editor]){let m=e[l.editor],h=S.code?.class;if(h||(typeof m=="function"?h=m:console.error("Editor class not provided in options.utilities.code")),h){let g=S.code?.options??{};g=typeof m=="boolean"?g:{...g,...m};let P=g.bind,w=new h(g);if(w.start(),n.editor=w,P!==void 0){let O=e,G=e[l.isGraphScript];P.split("/").forEach(U=>{if(U==="..")O=O[l.isGraphScript].states.parentNode[l.component];else{if(U===".")return;O=O[U]}}),G.boundEditors?G.boundEditors.push(w):G.boundEditors=[w]}}}return e[l.element][l.component]=e,e[l.element].setAttribute(l.attribute,""),e[l.element]=e[l.element],n.start.add(()=>{e[l.resize]=u.onresize,u.parentNode&&(e[l.parent]=u.parentNode)},"before"),n.stop.add(()=>{e[l.element].remove();let m=`${l.editor}Attached`;e[m]&&e[m].remove()}),e}var Ze={};k(Ze,{default:()=>Sn,name:()=>gn,properties:()=>xn,required:()=>_n});var gn="start",_n=!0,xn={dependents:[l.source],dependencies:[H,l.isGraphScript,l.editor,l.parent,l.proxy,l.connected,l.promise,l.resolved]},Sn=e=>{e[l.isGraphScript].start.add(()=>Pn(e))},vn=(e,t)=>e[l.isGraphScript].start.value=t;function Pn(e,t=[],o){wn.call(e,o);let n=En.call(e,t);return vn(e,!0),n}async function wn(e){let t=this[l.isGraphScript];await this[l.connected],t.connected=!0;let o=t.boundEditors;return o&&o.forEach(n=>n.setComponent(this)),e&&await e(),this}function En(e=[]){let t=this[l.isGraphScript],n=this[l.parent]?.[l.isGraphScript]?.editor;n&&(t.editor=n);let r=this[H];if(r){typeof r=="function"&&(r=this[l.source]=r()),delete this[H];let s=this[l.isGraphScript].path;t.editor&&t.editor.addFile(s,r)}return e.forEach(s=>s.call(this)),this}var et={};k(et,{default:()=>Ht,name:()=>On,properties:()=>kn});var K={},On="animate",Qe=l.animate,kn={dependents:[l.animate]};function Ht(e){if(e[Qe]){let t=e[Qe],o=Math.random(),n=typeof t=="number"?t:"global",r;if(K[n])r=()=>{e.default(),K[n].objects[o]=e};else{let s=K[n]={objects:{[o]:e}},i=s.objects,a=()=>{for(let p in i)i[p].default()};if(n==="global"){let p=()=>{a(),s.id=window.requestAnimationFrame(p)};r=p,K[n].stop=()=>{window.cancelAnimationFrame(s.id),s.cancel=!0}}else r=()=>{a(),s.id=setInterval(()=>a(),1e3/n)},K[n].stop=()=>clearInterval(s.id)}e[l.isGraphScript].start.add(r),e[l.isGraphScript].stop.add(()=>{delete K[n].objects[o],e[Qe]=t,Object.keys(K[n].objects).length===0&&(K[n].stop(),delete K[n])})}}var X=[];X.push(ze);A||X.push(Xe,Pe);X.push(Ze);X.push(et);var qt=Bt;var Jt=(e,t,o={})=>(o.loaders?o.loaders=Array.from(new Set([...o.loaders,...X])):o.loaders=X,Ve(e,t,o));var In=e=>{let t=document.getElementById(e);t?t.scrollIntoView({}):console.error(`No component found for path: ${e}`)},jn=!1,tt=class{constructor(t){this.paths={};this.set=(t,o)=>{o===void 0?delete this.paths[t]:this.paths[t]=o};this.setRoot=t=>this.set("",t);this.get=(t=this.getPath())=>{let o=this.paths;return t.split(/\.|\//).forEach(n=>o=o[n]??o[""][n]),o};this.load=(t,o,n=!0)=>{let r=t===void 0?this.getPath():t,s=this.get(r);s&&o&&o.preventDefault();let i=!s&&(!this.loaded||this.loaded.path!=="")&&n;if(i&&(r="",s=this.get("")),s){let a=this.options.element.root,p=r?this.options.element.target:void 0;if(p){(!this.loaded||this.loaded.path!==""&&r!=="")&&this.load(""),typeof p=="string"?a=document.querySelector(p):a=p;let u=[...a.children];if(a)for(let y of u)y.remove()}else this.loaded&&this.loaded.ref.__element.remove();let c=qt(s),f=Jt(c,{__parent:a});return console.log("Loaded",r,f),r===""&&(this.root&&this.root.__element.remove(),this.root=f),this.loaded={path:r,ref:f},p&&window.scrollTo(0,0),this.loaded}else In(r);i&&this.navigate(void 0,void 0,!1)};this.navigate=(t=this.getPath(),o,n=!1)=>{let r=t.split(/\.|\//).join(this.options.spa?"/":".");history.pushState({},"escodeRouterURL",this.options.spa?`${window.location.origin}/${r}`:`${window.location.origin}#${r}`),this.load(r,o,n)};this.getPath=t=>(t===void 0&&(this.options.spa&&(t=window.location.pathname.slice(1)),t||(t=window.location.hash.slice(1))),t??"");t=Object.assign({},t),t.element||(t.element={root:document.body}),(typeof t.element!="object"||!("root"in t.element))&&(t.element={root:t.element}),this.options=t,window.addEventListener("beforeunload",o=>this.load(void 0,o)),window.addEventListener("popstate",o=>this.load(void 0,o)),window.addEventListener("DOMContentLoaded",o=>{jn=!0,(!this.loaded||this.loaded.path==="")&&this.load(void 0,o)})}},Vt=tt;var Ee=new Vt({spa:!0,element:{root:document.body,target:"#content"}});Ee.setRoot(ke);Ee.set("about",Ce);Ee.set("work",Ie);Ee.load();
//# sourceMappingURL=index.esm.js.map
