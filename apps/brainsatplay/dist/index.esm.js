var Yt=Object.defineProperty;var k=(e,t)=>{for(var o in t)Yt(e,o,{get:t[o],enumerable:!0})};var Oe={};k(Oe,{content:()=>lo,footer:()=>co,nav:()=>ao});var le={};k(le,{__onconnected:()=>Xt,container:()=>Zt});function Xt(){this.header!==void 0&&(this.container.header.__element.innerText=this.header),this.text!==void 0&&(this.container.text.__element.innerHTML=this.text)}var Zt={header:{__element:"h3",__attributes:{innerText:"Header"}},text:{__element:"p",__attributes:{innerHTML:"This is the text."}}};var Q={};k(Q,{__attributes:()=>eo,__onconnected:()=>Qt,container:()=>to});function Qt(){["number","title","description"].forEach(t=>{this[t]!==void 0&&(this.container[t].__element.innerText=this[t])}),this.projects!==void 0&&this.projects.forEach(t=>{let o=document.createElement("li"),n=document.createElement("a"),r=document.createElement("sub");r.style.fontSize="75%",r.style.userSelect="none",t.active===!1?(o.style.opacity="0.5",o.style.pointerEvents="none",o.style.userSelect="none"):(t.oncreate&&t.oncreate(o),t.onclick?n.onclick=t.onclick:t.href&&(n.href=t.href)),o.appendChild(n),o.appendChild(r),n.innerText=t.name,r.innerText=` ${t.version}`,this.container.projects.__element.appendChild(o)})}var eo={style:{padding:"1rem"}},to={number:{__element:"p",__attributes:{innerText:"",style:{fontSize:"0.9rem",paddingBottom:"0.5rem",margin:"0px"}}},title:{__element:"h3",__attributes:{innerText:"Feature"}},description:{__element:"p",__attributes:{innerText:"This is a feature that is featured."}},projects:{__element:"ul"}};var Ee={};k(Ee,{__element:()=>so,__onconnected:()=>io,channel:()=>oo,height:()=>ro,width:()=>no});var oo="brainsatplay",no="100%",ro=480,so="div",io=function(){let e=document.createElement("script");e.src="https://embed.twitch.tv/embed/v1.js",document.body.appendChild(e),e.onload=()=>{new Twitch.Embed(this.__element,{width:this.width,height:this.height,channel:this.channel})}};var ot={borderBottom:"2px solid white",paddingBottom:"0.5rem",paddingRight:"1rem"},nt={list:[],__element:"ul",__onconnected:function(){this.__element.innerHTML="",this.list.forEach(e=>{let t=document.createElement("li"),o=document.createElement("a");o.innerText=e.label,t.appendChild(o),this.__element.appendChild(t),e.oncreate&&e.oncreate(t),e.onclick?o.onclick=e.onclick:o.href=e.href})}},rt=[{label:"Home",href:"/"},{label:"About",href:"#about"},{label:"Work",href:"#work"},{label:"Ethos",href:"#ethos"},{label:"Twitch",href:"#twitch"}],ao={__element:"nav",__childposition:0,__attributes:{style:{position:"fixed",top:"0px",right:"0px",paddingRight:"2rem"}},list:{list:rt,__compose:nt,__attributes:{style:{textTransform:"uppercase"}}}},lo={__element:"main",__childposition:0,hero:{__element:"section",__childposition:0,container:{title:{__element:"h1",__attributes:{innerText:"Brains@Play"}},subtitle:{__element:"h2",__attributes:{innerText:"The Universal Web Development Cooperative"}},description:{__element:"p",__attributes:{innerText:"We empower everyone to build better apps\u2014together."}}}},about:{__element:"section",__childposition:1,__attributes:{style:{background:"darkslategray"}},container:{title:{text:{__element:"h2",__attributes:{innerText:"About Us"}},support:{__element:"a",__attributes:{href:"https://opencollective.com/brainsatplay",target:"_blank"},image:{__element:"img",__attributes:{height:40,src:"https://opencollective.com/brainsatplay/contribute/button@2x.png?color=white"}}},__attributes:{style:{display:"flex",justifyContent:"space-between",alignItems:"center",...ot}}},description:{__element:"p",__attributes:{innerHTML:"Brains@Play is currently led by two developers\u2014<a href='https://github.com/garrettmflynn' target='_blank'>Garrett Flynn</a> and <a href='https://github.com/garrettmflynn' target='_blank'>Joshua Brewster</a>\u2014working to build a better Web with free software."}},statements:{__attributes:{style:{display:"flex",flexWrap:"wrap"}},mission:{header:"Mission",text:"Make code universally <a>shareable</a>, <a>modifiable</a>, and <a>usable</a>.",__compose:le,__attributes:{style:{flexBasis:"50%",padding:"15px"}}},vision:{header:"Vision",text:"Engulf the Web in public experiments of communal organization and citizen science, engineering, and art.",__compose:le,__attributes:{style:{flexBasis:"50%",padding:"15px"}}}}}},ethos:{__element:"section",__childposition:2,container:{title:{__element:"h2",__attributes:{innerText:"Our Ethos",style:{...ot}}},featureone:{number:"1",title:"Recompose the Web",description:"We are consuming the infrastructure of the Web.",projects:[{name:"ES Components (ESC)",link:"https://github.com/brainsatplay/escomponent",version:"0.1.7",description:"A specification for composable JavaScript objects with concurrent message-passing."},{name:"ESCode",link:"https://github.com/brainsatplay/escode",version:"0.2.0",description:"A framework for using ES Components using graphscript."},{name:"Web Source Accessibility Guidelines (WSAG)",active:!1,version:"0.0.0",description:"Identify best practices to allow anyone to use, modify, and share Web Components."}],__compose:Q},featuretwo:{number:"2",title:"Make Software Yours",description:"Bring yourself to every page.",projects:[{name:"Browser Extension",link:"https://github.com/brainsatplay/brainsatplay-extension",version:"0.0.0",oncreate:e=>{let t="brainsatplay-injection-proxy",o=r=>{window.postMessage({source:r,command:"openOptions"})},n=()=>{let r=!1;e.onclick=()=>{let i="https://github.com/brainsatplay/brainsatplay-extension";window.open(i,"_blank")};let s=document.getElementById(t);if(s&&s.getAttribute("data-version")){let a=s.getAttribute("data-id");r=!0,e.onclick=()=>o(a)}return r};window.onload=function(){n()||setTimeout(n,100)}},description:"Apply components across web pages."},{name:"Desktop App",link:"https://github.com/brainsatplay/brainsatplay-electron",version:"0.0.0",onclick:()=>{customProtocolCheck("brainsatplay://",()=>{window.open("https://github.com/brainsatplay/brainsatplay-desktop","_blank"),console.log("Custom protocol not found.")},()=>{console.log("Custom protocol found and opened the file successfully.")})},description:"Create composable cross-platform web systems."}],__compose:Q},featurethree:{number:"3",title:"Free Public Experimentation",description:"We are supporting new scientific and human-computer interaction (HCI) advances that drive experimentation on the Web and translate quickly across sites.",projects:[{name:"WebNWB",link:"https://github.com/brainsatplay/webnwb",description:"Enable citizen neuroscience.",version:"0.0.12"},{name:"MyAlyce",link:"https://myalyce.com",description:"Enable citizen neuroscience.",version:"0.0.0"}],__compose:Q}}},twitch:Ee},co={__element:"footer",__childposition:2,__attributes:{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",backgroundColor:"black",color:"white",padding:"25px 50px"}},title:{text:{__element:"span",__attributes:{innerText:"\xA9 Brains@Play 2022"}}},links:{__compose:nt,list:[...rt]},social:{__element:"ul",email:{__element:"li",link:{__element:"a",__attributes:{href:"mailto:contact@brainsatplay.com",innerText:"contact@brainsatplay.com"}}},newsletter:{__element:"li",link:{__element:"a",__attributes:{href:"https://brainsatplay.substack.com",innerText:"Sign up for our newsletter",style:{fontSize:"0.8rem"}}}}}};var ke={};k(ke,{hero:()=>po});var po={__element:"section",container:{title:{__element:"h1",__childposition:0,__attributes:{innerText:"About Us"}},subtitle:{__element:"h2",__childposition:1,__attributes:{innerText:"It all began with a dream of agency for every brain."}},description:{__element:"p",__childposition:2,__attributes:{innerText:"We started working in 2021 and never stopped."}},message:{__element:"p",__childposition:3,__attributes:{innerText:"Now it's cool to have a brain!"}}}};var Ce={};k(Ce,{hero:()=>fo});var fo={__element:"section",container:{title:{__element:"h1",__attributes:{innerText:"Our Work"}},subtitle:{__element:"h2",__attributes:{innerText:"The Universal Web Development Cooperative"}}}};var uo="[object Module]",z=e=>!!(e&&(!!Object.keys(e).reduce((o,n)=>{let r=Object.getOwnPropertyDescriptor(e,n),s=r&&r.get&&!r.set?1:0;return o+s},0)||Object.prototype.toString.call(e)===uo));var it=(e,t)=>{if(e&&typeof e=="object"&&t&&typeof t=="object"){let o=JSON.stringify(e),n=JSON.stringify(t);return o===n}else return e===t},W=(e,t)=>Promise.all(Object.getOwnPropertySymbols(e).map(o=>t(o,e[o]))),C=(e,t)=>{let o=t.path[e];if(!o)throw new Error("Invalid Path Type");return o.filter(r=>typeof r=="string").join(t.keySeparator)},ce=(e,t)=>{let o=e;return typeof e=="string"?o=e.split(t.keySeparator):typeof e=="symbol"&&(o=[e]),{id:o[0],path:o.slice(1)}},N=(e,t,o,n,r=!0)=>{if(e instanceof Function&&(n&&typeof n=="object"&&typeof n.then=="function"?n.then(s=>e(t,o,s)):e(t,o,n)),r&&globalThis.ESMonitorState){let s=globalThis.ESMonitorState.callback;globalThis.ESMonitorState.state[t]={output:n,value:o},N(s,t,o,n,!1)}};var mo=60,ee=class{constructor(t,o){this.listeners={};this.setOptions=(t={})=>{for(let o in t)this[o]=t[o]};this.add=t=>{let o=t.sub;return this.listeners[o]=t,this.start(),!0};this.get=t=>this.listeners[t];this.remove=t=>{delete this.listeners[t],Object.keys(this.listeners).length||this.stop()};this.poll=t=>{W(t,(o,n)=>{let{callback:r,current:s,history:i}=n;n.path.resolved||(n.path.resolved=C("output",n)),it(s,i)||(N(r,n.path.resolved,{},s),typeof s=="object"?Array.isArray(s)?i=[...s]:i={...s}:t[o].history=s)})};this.start=(t=this.listeners)=>{this.sps?this.#e||(console.warn("[esmonitor]: Starting Polling!"),this.#e=setInterval(()=>this.poll(t),1e3/this.sps)):this.sps=mo};this.stop=()=>{this.#e&&(console.warn("[esmonitor]: Stopped Polling!"),clearInterval(this.#e),this.#e=void 0)};t&&(this.listeners=t),o&&(this.sps=o)}#e;#t;get sps(){return this.#t}set sps(t){this.#t=t;let o=this.listeners;Object.keys(o).length&&(this.stop(),this.start())}};var oe={};k(oe,{functionExecution:()=>de,functions:()=>ht,getProxyFunction:()=>Me,info:()=>ye,register:()=>mt,set:()=>Le,setterExecution:()=>me,setters:()=>Ge});globalThis.ESMonitorState={state:{},callback:void 0,info:{}};var lt=globalThis.ESMonitorState;var ho=async(e,t)=>{let o=globalThis.performance.now(),n=await e(...t),r=globalThis.performance.now();return{output:n,value:r-o}},ct={performance:ho},pt=(e,t,o)=>{let n={value:{},output:void 0},r={...lt.info,...o};for(let s in r)if(r[s]&&ct[s]){let i=e;e=async(...a)=>{let c=await ct[s](i,a);return n.value[s]=c.value,c.output}}return n.output=e(...t),n};var I=Symbol("isProxy"),te=Symbol("fromInspectable"),Tn=Symbol("fromInspectableHandler");var j=".",bo="default",H="__esmpileSourceBundle",Ie={isGraphScript:"__",properties:"__props",default:bo,parent:"__parent",promise:"__childresolved",component:"__component",proxy:"__proxy"},l={...Ie,start:"__onconnected",stop:"__ondisconnected",connected:"__connected",resolved:"__resolved",started:"__started",element:"__element",webcomponents:"__define",attributes:"__attributes",listeners:{value:"__listeners",branch:"__branch",bind:"__bind",trigger:"__trigger",format:"__format"},trigger:"__trigger",compose:"__compose",apply:"__apply",uri:"src",reference:"ref",childPosition:"__childposition",attribute:"escomponent",options:"__options",source:"__source",path:"__path",animate:"__animate",states:"__states",editor:"__editor",original:"__original",resize:"__onresize"};var ft=(e,t)=>e in t,go=(e,t,o)=>{let n=t[e[0]];if(n){let r=n[e.slice(1).join(o)];if(r)return r}},pe=(e,t,o={})=>{let n=o.fallbacks??[],r=o.keySeparator??j;if(o.shortcuts){let c=go(t,o.shortcuts,r);if(c)return o.output==="info"?{value:c,exists:!0,shortcut:!0}:c}typeof t=="string"?t=t.split(r).flat():typeof t=="symbol"&&(t=[t]);let s;t=[...t],t=t.map(c=>typeof c=="string"?c.split(r):c).flat();let i=e,a=[i];for(let c=0;c<t.length;c++)if(i){let p=t[c];s=ft(p,i),s?i=i[p]:(i=void 0,s=!0),a.push(i)}return o.output==="info"?{value:i,exists:s,parent:a[a.length-2]}:i},fe=(e,t,o,n={})=>{let r=n?.create??!1,s=n?.keySeparator??j;typeof e=="string"?e=e.split(s):typeof e=="symbol"&&(e=[e]),e=[...e];let i=[...e],a=i.pop();for(let c=0;c<i.length;c++){let p=i[c],f=ft(p,o);r&&!f&&(o[p]={},f=!0),f&&(o=o[p])}return o[a]=t,!0};var Te={};k(Te,{functions:()=>xo,objects:()=>Ae});function _o(e,t){let o=this,n=this.target;if(!this.parent){let r=n[e];try{Object.defineProperty(n,e,{get:()=>r,set:function(s){r=s,o.proxy[e]={[I]:this[I],[te]:!0,value:s}},enumerable:!0,configurable:!0})}catch{console.error(`Could not reassign ${e} to a top-level setter...`)}}t&&this.newKeys.add(e),this.create(e,n,void 0,!0)}var ue=_o;var xo=function(){let e=this;return{apply:async function(t,o,n){try{let r=t;n[0]?.[te]&&(r=n[0].value,n=n.slice(1));let i=e.listeners.functions,a=e.path.join(e.options.keySeparator),c=i?i[a]:void 0,p,f={};c?(f=de(o,c,r,n),p=f.output):(p=r.apply(o,n),f=e?.state?.[a]?.value??{});let u=e.options.callback;return N(u,a,f,p),p}catch(r){console.warn("Function failed:",r,e.path)}}}},Ae=function(){let e=this;return{get(t,o,n){return o===I?!0:Reflect.get(t,o,n)},set(t,o,n,r){if(o===I)return!0;let s=[...e.path,o].join(e.options.keySeparator),i=n?.[I],a=n?.[te];a&&(n=n.value);let c=e.listeners.setters,p=Object.getOwnPropertyDescriptor(t,o);if(p&&!p.get&&!p.set&&typeof e.options.globalCallback=="function"){let h=e.path[0];ue.call(e,o,!0),Le("setters",s,n,e.options.globalCallback,{[h]:e.root},e.listeners,e.options)}if(n||typeof n=="function"){let h=e.create(o,t,n);h&&(n=h)}let u=!i;if(c&&u&&!e.newKeys.has(o)){let h=c[s];h&&me(h,n)}let y=e.options.callback,v=e?.state?.[s]?.value??{};return N(y,s,v,n),a||!u?!0:Reflect.set(t,o,n,r)}}};var A=typeof process=="object";var So=(e,t,o)=>{try{o===void 0&&(o=e[t])}catch(p){return p}if(e[t]&&e[t][I])return!1;let r=typeof o,s=r==="object",i=r=="function";if(!o||!(s||i)||!A&&o instanceof Element||o instanceof EventTarget)return!1;let c=s&&z(o);if(i)return!0;{let p=Object.getOwnPropertyDescriptor(e,t);if(p&&(p.value&&p.writable||p.set)){if(!c)return!0}else if(!e.hasOwnProperty(t))return!0}return!1},B=class{constructor(t={},o={},n,r){this.path=[];this.listeners={};this.newKeys=new Set;this.state={};this.set=(t,o,n)=>{this.state[t]={output:n,value:o},fe(t,n,this.proxy,{create:!0})};this.check=So;this.create=(t,o,n,r=!1)=>{let s=this.check(o,t,n);if(n===void 0&&(n=o[t]),s&&!(s instanceof Error))return o[t]=new B(n,this.options,t,this),o[t];if(r)try{this.proxy[t]=n??o[t]}catch(i){let a=z(o),c=[...this.path,t];console.error(`Could not set value (${c.join(this.options.keySeparator)})${a?" because the parent is an ESM.":""}`,a?"":i)}};if(o.pathFormat||(o.pathFormat="relative"),o.keySeparator||(o.keySeparator=j),t.__proxy)this.proxy=t.__proxy;else if(t[I])this.proxy=t;else{this.target=t,this.options=o,this.parent=r,this.parent?(this.root=this.parent.root,this.path=[...this.parent.path],this.state=this.parent.state??{}):this.root=t,n&&this.path.push(n),this.options.listeners&&(this.listeners=this.options.listeners),this.options.path&&(this.options.path instanceof Function?this.path=this.options.path(this.path):Array.isArray(this.options.path)?this.path=this.options.path:console.log("Invalid path",this.options.path)),this.path&&(this.path=this.path.filter(a=>typeof a=="string")),this.options.keySeparator||(this.options.keySeparator=j);let s=this.options.type;s!="object"&&(s=typeof t=="function"?"function":"object");let i=Te[`${s}s`].call(this);s==="function"&&(i={...i,...Ae.call(this)}),this.proxy=new Proxy(t,i),Object.defineProperty(t,"__proxy",{value:this.proxy,enumerable:!1}),Object.defineProperty(t,"__esInspectable",{value:this,enumerable:!1});for(let a in t)ue.call(this,a)}return this.proxy}};var he=(e,t,o,n)=>{let r=n.reference,s=Array.isArray(e)?e[0]:typeof e=="string"?e.split(o.keySeparator)[0]:e,i=n.hasOwnProperty("static")?!n.static:!1;i&&!globalThis.Proxy&&(i=!1,console.warn("Falling back to using function interception and setters...")),i&&(t=new B(t,{pathFormat:o.pathFormat,keySeparator:o.keySeparator,listeners:n.listeners,path:c=>c.filter(p=>!o.fallbacks||!o.fallbacks.includes(p))},s));let a={keySeparator:o.keySeparator,...n};return fe(e,t,r,a),t};var ye=(e,t,o,n,r,s,i,a={})=>{typeof o=="string"&&(o=o.split(i.keySeparator));let c=o.join(i.keySeparator),p=r,f=a.ref,u=a.path,y=d=>pe(f??r,d,{keySeparator:i.keySeparator,fallbacks:i.fallbacks}),v=(d,b)=>{he(d,b,i,{reference:f??r,listeners:s})},h=i.onUpdate,x={};h&&typeof h=="object"&&h.callback instanceof Function&&(x=h.info??{},h=h.callback);let g=[e,...o],_={absolute:g,relative:c.split(i.keySeparator),parent:g.slice(0,-1)};_.output=_[i.pathFormat];let m={id:e,path:_,keySeparator:i.keySeparator,infoToOutput:x,callback:(...d)=>{let b=t(...d);return h instanceof Function&&h(...d),b},get current(){return y(u??m.path.absolute)},set current(d){v(u??m.path.absolute,d)},get parent(){return y(u?u?.slice(0,-1):m.path.parent)},get reference(){return p[e]},set reference(d){p[e]=d},original:n,history:typeof n=="object"?Object.assign({},n):n,sub:Symbol("subscription"),last:o.slice(-1)[0]};return m},ut=(e,t,o)=>{if(o){let n=Math.random();o.symbol[t]={name:e,id:n},o.name[e]||(o.name[e]={}),o.name[e][n]=t}},mt=(e,t,o)=>{let n=C("absolute",e);return t[n]||(t[n]={}),t[n][e.sub]=e,ut(n,e.sub,o),!0},Fe={functions:ht,setters:Ge},Le=(e,t,o,n,r,s,i)=>{let{id:a,path:c}=ce(t,i),p=ye(a,n,c,o,r,Fe,i);if(Fe[e])Fe[e](p,s,s.lookup);else{let f=C("absolute",p);s[e][f][p.sub]=p,s.lookup&&ut(f,p.sub,s.lookup)}},vo=(e,t)=>t[C("absolute",e)],dt=(e,t,o,n)=>{let r=!!vo(e,t);if(!r){let s=e.parent,i=s?.[e.last];r=o(i,s)}return mt(e,t,n)},me=(e,t)=>W(e,(o,n)=>{let r=C("output",n);N(n.callback,r,{},t)});function Ge(e,t,o){let n=this;return dt(e,t.setters,(r,s)=>{let i=r;if(!!s&&!s[I]){let a=!0;try{delete s[e.last]}catch{console.error("Unable to redeclare setters. May already be a dynamic object..."),a=!1}if(a){let c=e.last.slice(0,2)==="__"||e.last==="default";try{Object.defineProperty(s,e.last,{get:()=>i,set:async p=>{let f=typeof i=="function";if(i=p,f)i=Me.call(n,e,t,i);else{let u=Object.assign({},t.setters[C("absolute",e)]);me(u,p)}},enumerable:!c,configurable:!0})}catch(p){throw p}}}},o)}function Me(e,t,o){return function(...n){let r=t.functions[C("absolute",e)];return de(this,r,o??e.original,n).output}}var de=(e,t,o,n)=>{t=Object.assign({},t);let r=Object.getOwnPropertySymbols(t),s=t[r[0]]??{},i=pt((...a)=>o.call(e,...a),n,s.infoToOutput);return W(t,(a,c)=>{let p=C("output",c);N(c.callback,p,i.value,i.output)}),i};function ht(e,t,o){return dt(e,t.functions,(n,r)=>{if(!r[I])return r[e.last]=Me.call(this,e,t),Ge(e,t,o)},o)}var M=Symbol("abort"),yt=(e,t=[])=>({typeof:typeof e,name:e?.constructor?.name,simple:!0,object:e&&typeof e=="object",path:t}),q=(e,t,o={})=>{let n=o.accumulator;n||(n=o.accumulator={});let r=o.ignore||[],s=o.path||[],i=o.condition||!0,a=[],c=[],p=(f,u={},y)=>{let v=y.path;if(v.length===0&&!(i instanceof Function?i(void 0,f,{...yt(f,v)}):i))return f;for(let h in f){if(o.abort)return;if(r.includes(h))continue;let x=f[h],g=[...v,h],_=yt(x,g);if(_.object){let S=_.name;if(z(x)||S==="Object"||S==="Array"){_.simple=!0;let d=a.indexOf(x);if(d!==-1)u[h]=c[d];else{a.push(x);let b=i instanceof Function?i(h,x,_):i;_.pass=b;let P=t(h,x,_);if(P===M)return M;if(u[h]=P,b){c.push(u[h]);let E=p(x,u[h],{...y,path:g});if(E===M)return M;u[h]=E}}}else{_.simple=!1;let d=t(h,x,_);if(d===M)return M;u[h]=d}}else{let S=t(h,x,_);if(S===M)return M;u[h]=S}}return u};return p(e,n,{path:s})};var bt=()=>({symbol:{},name:{}}),Po=typeof process=="object",ne=class{constructor(t={}){this.poller=new ee;this.options={pathFormat:"relative",keySeparator:j};this.listeners={polling:this.poller.listeners,functions:{},setters:{},lookup:bt()};this.references={};this.get=(t,o,n=this.references)=>pe(n,t,{keySeparator:this.options.keySeparator,fallbacks:this.options.fallbacks,output:o});this.set=(t,o,n={})=>{let r={...n};return r.reference||(r.reference=this.references),r.listeners||(r.listeners=this.listeners),he(t,o,this.options,r)};this.on=(t,o)=>{let n=ce(t,this.options);return this.listen(n.id,o,n.path)};this.getInfo=(t,o,n,r)=>{let s=ye(t,o,n,r,this.references,this.listeners,this.options),i=Math.random(),a=this.listeners.lookup,c=C("absolute",s);return a.symbol[s.sub]={name:c,id:i},a.name[c]||(a.name[c]={}),a.name[c][i]=s.sub,s};this.listen=(t,o,n=[],r={})=>{typeof n=="string"?n=n.split(this.options.keySeparator):typeof n=="symbol"&&(n=[n]);let s=n,i=this.get(t);if(!i){console.error("Reference does not exist.",t);return}r.poll||(r.poll=z(i)),r.seen||(r.seen=[]);let a=r,c=[t,...s],p=this.get(c),f=(x,g=!1)=>!(x&&typeof x=="object")||!Po&&x instanceof Element?!1:g?!0:!Array.isArray(x),u={},y=!1;f(p,!0)&&(p.__esInspectable&&(p.__esInspectable.options.globalCallback=o),q(p,(x,g,_)=>{if(!_.pass){let S=[...s,..._.path],m=this.listen(t,o,S,a);Object.assign(u,m)}},{condition:(x,g)=>f(g)}),y=!0);let h;try{if(h=this.getInfo(t,o,s,p),h&&!y)if(a.poll)y=this.poller.add(h);else{let x="setters";typeof p=="function"&&(x="functions"),y=this.add(x,h)}}catch(x){console.error("Fallback to polling:",n,x),y=this.poller.add(h)}if(y){if(u[C("absolute",h)]=h.sub,this.options.onInit instanceof Function){let x={};for(let g in h.infoToOutput)x[g]=void 0;this.options.onInit(C("output",h),x)}return u}else{console.error("Failed to subscribe to:",n);return}};this.add=(t,o)=>oe[t]?oe[t](o,this.listeners,this.listeners.lookup):(this.listeners[t][C("absolute",o)][o.sub]=o,!0);this.remove=t=>{t||(t={...this.listeners.functions,...this.listeners.setters,...this.listeners.polling}),typeof t!="object"&&(t={sub:t});for(let o in t){let n=t[o],r=s=>{this.unsubscribe(s)===!1&&console.warn(`Subscription for ${o} does not exist.`,s)};typeof n!="symbol"?W(n,r):r(n)}return!0};this.unsubscribe=t=>{let o=this.listeners.lookup.symbol[t],n=o.name,r=this.poller.get(t),s=this.listeners.functions[n],i=s?.[t],a=this.listeners.setters[n],c=a?.[t];if(r)this.poller.remove(t);else if(i)delete s[t],Object.getOwnPropertySymbols(s).length||(Object.defineProperty(i.parent,i.last,{value:i.original,writable:!0}),delete this.listeners.functions[n]);else if(c){if(delete a[t],!Object.getOwnPropertySymbols(a).length){let f=c.parent;if(f){let u=c.last,y=f[u];Object.defineProperty(f,u,{value:y,writable:!0})}delete this.listeners.setters[n]}}else return!1;delete this.listeners.lookup.symbol[t];let p=this.listeners.lookup.name[o.name];delete p[o.id],Object.getOwnPropertyNames(p).length||delete this.listeners.lookup.name[o.name]};Object.defineProperty(this.listeners,"lookup",{value:bt(),enumerable:!1,configurable:!1}),Object.assign(this.options,t),this.poller.setOptions(t.polling)}};var re=ne;var Re={},gt=["Object","Array","Map","Set"];function T(e){var t=[];if(e)do{let o=e.constructor?.name,n=gt.includes(o);gt.includes(o)&&(Re[o]||(Re[o]=[...Object.getOwnPropertyNames(globalThis[o].prototype)])),Object.getOwnPropertyNames(e).forEach(function(r){n&&Re[o].includes(r)||t.indexOf(r)===-1&&t.push(r)})}while(e=Object.getPrototypeOf(e));return t}var Ne=(e,t={})=>{if(typeof e=="object")if(Array.isArray(e))e=[...e],t.accumulator=[];else{let o=T(e),n={};for(let r of o)n[r]=e[r];e=n,t.accumulator={}}return e},L=(e,t={})=>typeof e!="object"?e:(e=Ne(e,t),q(e,(o,n,r)=>r.simple&&r.object?Array.isArray(n)?[]:{}:n,t),t.accumulator);var _t=e=>typeof e=="object"&&typeof e.then=="function",w=(e,t)=>(typeof e=="object"&&Array.isArray(e)&&e.find(o=>_t(o))&&(e=Promise.all(e)),_t(e)?new Promise(o=>{e.then(async n=>{let r=t?t(n):n;o(r)})}):t?t(e):e),xt=[],J=(e,t,o=!1,n=!1,r=!1,s=[])=>{let i=o?e:Ne(e);if(n&&([i,t]=[t,i]),t){let a=T(i),c=new Set(T(t));a.forEach(p=>{c.delete(p);let f=p in t,u=t[p];if(f&&u===void 0)delete i[p];else if(typeof u=="object"&&!Array.isArray(u))if(typeof i[p]=="object"){let y=i[p],v=s.indexOf(y);v!==-1?i[p]=s[v]:(s.push(y),i[p]=J(y,u,o,!1,r,s))}else i[p]=u;else if(typeof u=="function"){let y=i[p],v=typeof y=="function",h=u,x=h.__compose===!0;if(!v||!r&&!x)i[p]=h;else{let g=xt.find(S=>S.f===y),_=y;if(g||(_.__esInspectable&&(_=_.__esInspectable.target),g={f:_,list:[_]},xt.push(g)),g.list.includes(h))console.warn("This function was already composed. Ignoring duplicate.");else{let S=i[p]=function(...m){let d=_.call(this,...m);return h.call(this,...Array.isArray(d)?d:[d])};g.f=S,g.list.push(h)}}}else p in t&&(i[p]=u)}),c.forEach(p=>{let f=t[p];f!==void 0&&(i[p]=f)})}return i};function be(e){return wo(e)==="class"}function wo(e){return typeof e=="function"?e.prototype?Object.getOwnPropertyDescriptor(e,"prototype").writable?"function":"class":e.constructor.name==="AsyncFunction"?"async":"arrow":""}var $e={};k($e,{behavior:()=>jo,default:()=>Ke,name:()=>Io,properties:()=>Ao});var Oo=async(e,t)=>{let o=await fetch(e).then(n=>n.arrayBuffer());return WebAssembly.instantiate(o,t)},ko=async(e,t)=>(t||(t={env:{abort:()=>console.log("Abort!")}}),WebAssembly.instantiateStreaming?await WebAssembly.instantiateStreaming(fetch(e),t):await Oo(e,t)),St=ko;var vt=(e,t)=>e[l.reference]?(console.warn("[escode]: Falling back to ES Component reference...",t),e[l.reference]):Co(t.message),Pt=`Cannot transform ${l.compose} string without a compose utility function`;function ge(e,t){let o=typeof e=="string"?e:e[l.uri];if(o&&o.slice(-5)===".wasm"){let n=e.relativeTo??t?.relativeTo??window.location.href;n.slice(-1)[0]!=="/"&&(n+="/");let r=new URL(o,n).href;return new Promise(async s=>{let i=await St(r,e.importOptions),a=Object.assign({},i.instance.exports);for(let c in a){let p=a[c];p instanceof WebAssembly.Memory?a[c]=new Uint8Array(p.buffer):p instanceof WebAssembly.Global&&Object.defineProperty(a,c,{get:()=>p.value,set:f=>p.value=f})}s(a)})}else if(o&&t.utilities){let n=t.utilities.bundle,r=n&&typeof n.function=="function",s=t.utilities.compile,i=s&&typeof s.function=="function";if(!r&&!i)e=vt(e,new Error(Pt));else return new Promise(async a=>{try{if(r){let c=n.options??{};c.bundler||(c.bundler="datauri"),c.bundle||(c.collection="global"),c.relativeTo||(c.relativeTo=t.relativeTo??".");let p=n.function(o,c);await p.compile(),e=Object.assign({},p.result)}else if(i){let c=s.options??{};c.relativeTo||(c.relativeTo=t.relativeTo??"."),e=await s.function(e,c)}else throw new Error(Pt)}catch(c){e=vt(e,c)}a(L(e))})}return L(e[l.reference]??e)}function Co(e){return{[l.element]:"p",b:{[l.element]:"b",[l.attributes]:{innerText:"Error: "}},span:{[l.element]:"span",[l.attributes]:{innerText:e}}}}var Io="compose",V={compose:l.compose,apply:l.apply,bundle:H},jo="load",Ao={dependents:Object.values(V)},To=e=>typeof e=="string"&&(e.includes("/")||e.includes("."));function Lo(e,t,o,n=!1){return e=J(e,t,n),e=wt(e,e[V.compose],o,!0,n),w(e,r=>{let s=r[V.apply];return r=s&&(typeof s=="object"||To(s))?wt(r,s,o,!1,n):r,w(r)})}var Ke=Lo;function wt(e,t={},o={},n=!1,r=!1){Array.isArray(t)||(t=[t]);let s=w(t.map(i=>{let a=ge(i,o),c=(p,f=[],u=!0)=>{if(Array.isArray(p))p.forEach(y=>c(y,f),!0);else if(p[V.compose]){f.push(p);let y=p[V.compose];delete p[V.compose];let v=w(ge(y,o));c(v,f)}else u&&f.push(p);return f};return w(a,p=>c(p))}));return w(s,i=>{let a=i.flat(),c={};return a.forEach(p=>c=J(c,p,!1,!1)),J(e,c,r,n)})}var se=Symbol("return");var Fo=e=>typeof e=="function"&&e.hasOwnProperty("prototype")&&!e.hasOwnProperty("arguments");function ze(e,t={},o={}){if(A||e instanceof NodeList&&(e=Array.from(e)),typeof e=="string")e={[l.apply]:e};else if(typeof e=="function")Fo(e)?e=new e(t,o):(delete e.__,e={[l.default]:e});else if(!A&&e instanceof Element){let n=e[l.component];if(n){t=L(t);let r=t.__compose,s=t.__apply;return delete t.__compose,delete t.__apply,r&&(console.warn("Cannot compose a component onto an element that already has a component. Merging with the base object instead..."),t=Object.assign(r,t)),s&&(console.warn("Cannot apply a component onto an element that already has a component. Applying to the base object instead..."),t=Object.assign(t,s)),Ke(n,t,o,!0),{[se]:n}}else e={[l.element]:e}}else{if(Array.isArray(e))return e;if(typeof e=="object")e=o.clone!==!1?L(e):e;else throw new Error(`Invalid configuration type: ${typeof e}. Expected object or string.`)}return e}var Et=e=>{let t=L(e),o;return t.monitor instanceof re?(o=t.monitor,t.keySeparator=o.keySeparator):(t.monitor||(t.monitor={}),t.monitor.keySeparator||(t.keySeparator||(t.keySeparator=j),t.monitor.keySeparator=t.keySeparator),t.monitor=new re(t.monitor)),t};globalThis.escomposePerformance={create:[],resolve:[],resolveAll:[],listeners:{create:[],resolve:[]},averages:function(){let e={create:0,resolve:0,resolveAll:0,listeners:{create:0,resolve:0}};for(let t in e)if(typeof this[t]=="object"&&!Array.isArray(this[t]))for(let o in this[t])e[t][o]=this[t][o].reduce((n,r)=>n+r,0)/this[t][o].length;else e[t]=this[t].reduce((o,n)=>o+n,0)/this[t].length;return e}};var Ot="default",kt="__operator",F={path:"__path",isGraphScript:"__",listeners:{value:"__listeners",branch:"__branch",bind:"__bind",trigger:"__trigger",format:"__format"}},Ct=Symbol("listenerObject"),It=Symbol("toSet"),ie=Symbol("subscriptionKey"),jt=Symbol("configKey"),We=Symbol("toResolveWithKey"),Go=e=>F.listeners.format in e||F.listeners.branch in e||F.listeners.trigger in e||F.listeners.bind in e,At="INITIALIZED",Tt="REGISTERED",Mo={},Ro={},No={},Be=class{constructor(t,o,n){this.original={};this.active={};this.globals={};this.context={options:{}};this.rootPath="";this.status="";this.#e=[];this.#t=[];this.setInitialProperties=(t={},o,n={})=>{Object.assign(this.context,n),o&&(this.rootPath=o),this.context.options.keySeparator||(this.context.options.keySeparator=this.context.monitor.options.keySeparator),this.original=t,[{name:"active",ref:No},{name:"from",ref:Mo},{name:"to",ref:Ro}].forEach(s=>{s.ref[this.context.id]||(s.ref[this.context.id]={}),this.globals[s.name]=s.ref[this.context.id]}),this.#n=this.getManager(),this.runEachListener(t,this.addToGlobalLog)};this.getManager=(t="from")=>{let o=t==="to"?this.globals.to:this.globals.from;return this.rootPath.split(this.context.options.keySeparator).forEach(n=>{o[n]||(o[n]={}),o=o[n]}),o[We]??this};this.onStart=t=>{let o=this.#n;o===this?this.status===At?t():this.#t.push(t):o.onStart(t)};this.runEachListener=(t,o)=>{if(!!o)for(let n in t){let r=t[n];if(!r){console.warn("Skipping empty listener:",n);continue}if(r&&typeof r=="object"){let s=r,i=n;for(let a in s)o(a,i,s[a])}else{let s=n,i=r,a=typeof i;a==="function"?o(s,"",i):a==="string"?o(s,i,i):console.error("Improperly Formatted Listener",i)}}};this.register=(t=this.original)=>{this.runEachListener(t,this.add),this.status=Tt};this.#s=t=>{let o=this.context.monitor.get(t.path,"info");if(typeof o.value=="function"){let n=Array.isArray(t.args)?t.args:[t.args];o.value(...n)}else console.error("Cannot yet trigger values...",t)};this.initialize=t=>{this.status?this.status===Tt?(this.status=At,this.#e.forEach(this.#s),this.#t.forEach(o=>o()),this.#t=[],this.#e=[]):this.#s(t):this.#e.push(t)};this.start=()=>{this.register(),this.initialize()};this.#r=t=>{let o=this.context.monitor.options.keySeparator;return!t||!this.rootPath||this.rootPath===t.slice(0,this.rootPath.length)&&t[this.rootPath.length]===o?t:[this.rootPath,t].join(o)};this.#o=t=>{let o={absolute:{},relative:{}};t=this.#r(t);let n=this.rootPath?t.replace(`${this.rootPath}.`,""):t,r=t.split(this.context.options.keySeparator);o.absolute.array=[this.context.id,...r],o.relative.array=n.split(this.context.options.keySeparator);let s=this.context.monitor.get(o.absolute.array,void 0);if(this.context.graph){if(s&&this.context.bound)o.absolute.array=[this.context.id,this.context.bound,...o.absolute.array.slice(1)],o.relative.array.unshift(this.context.bound);else if(!s){let f=o.relative.array.join(this.context.options.keySeparator);s=this.context.graph.get(f)}}let i=s&&typeof s=="object"&&F.isGraphScript in s,a=s&&i&&s[kt],c=s&&s[Ot],p=a?kt:c?Ot:void 0;return p&&(o.absolute.array.push(p),o.relative.array.push(p)),o.absolute.value=o.absolute.array.slice(1).join(this.context.options.keySeparator),o.relative.value=o.relative.array.join(this.context.options.keySeparator),o};this.add=(t,o,n=!0,r)=>{let s=performance.now();if(!n)return;let i=this.#o(t),a=this.#o(o),c=i.absolute.value;r||(r=this.globals.active[c]?.[ie]),r||(r=this.context.monitor.on(i.absolute.array,(v,h,x)=>this.activate(v,x),{ref:this.context.instance,path:i.relative.array})),typeof n=="string"&&(n=a.absolute.array.slice(1).join(this.context.options.keySeparator));let p={value:n,[Ct]:!0};[this.active,this.globals.active].forEach(v=>{v[c]||(v[c]={});let h=v[c];h[ie]||Object.defineProperty(h,ie,{value:r,configurable:!0}),h[a.absolute.value]=p});let u=n[F.listeners.trigger];u&&this.#n.initialize({path:i.absolute.array,args:u}),this.addToGlobalLog(c);let y=performance.now();return globalThis.escomposePerformance.listeners.create.push(y-s),p};this.addToGlobalLog=(t,o="from")=>{let n=this.#r(t),r=o==="to"?this.globals.to:this.globals.from;n.split(this.context.options.keySeparator).forEach(i=>{r[i]||(r[i]={}),r=r[i],r[We]||(r[We]=this)})};this.remove=(t,o)=>{let n=this.#o(t),r=this.#o(o),s=[n.absolute.value,r.absolute.value];[{ref:this.active,path:s},{ref:this.globals.active,path:s,unlisten:!0}].forEach(a=>{let{ref:c,path:p,unlisten:f}=a,u=c[p[0]];if(typeof u=="object"){if(delete u[p[1]],Object.keys(u).length===0){delete c[p[0]];let y=u[ie];f&&y&&this.context.monitor.remove(y),delete u[ie]}}else delete c[p[0]]})};this.clear=t=>{let o=this.#r(t);Object.keys(this.active).forEach(n=>{Object.keys(this.active[n]).forEach(r=>{(!o||n.slice(0,o.length)===o||r.slice(0,o.length)===o)&&this.remove(n,r)})})};this.has=(t,o=this.active)=>!!o[t];this.get=(t,o=this.active)=>o[t];this.activate=(t,o)=>{[{info:this.get(t,this.globals.active),name}].forEach(r=>{let s=r.info;if(s)if(s[Ct]){let i=performance.now();this.pass(t,{value:s.value,parent:this.active,key:r.name,subscription:s.subscription,__value:!0},o);let a=performance.now();globalThis.escomposePerformance.listeners.resolve.push(a-i)}else if(typeof s=="object"){let i=performance.now();for(let a in s){this.pass(t,{parent:s,key:a,subscription:s[a].subscription,value:s[a].value},o);let c=performance.now();globalThis.escomposePerformance.listeners.resolve.push(c-i)}}else console.error("Improperly Formatted Listener",s)})};this.pass=(t,o,n)=>{let r=this.context.id,s=o?.__value,i=o.parent,a=o.key,c=o.parent[a];o=c.value;let p=c?.[jt],f=o,u=typeof o,y=(g,_)=>{let S=this.context.monitor.get(g,"info");if(S.exists){let m=S.value,P={value:typeof m!="function"&&!m?.default?It:m,bound:S.parent};return _&&(o=P.value,i[a]=P),P}else return{value:void 0}},v=g=>{let _=[r];return _.push(...a.split(this.context.options.keySeparator)),y(_,g)},h=g=>{let _=[r],S=[];return this.rootPath&&S.push(...this.rootPath.split(this.context.options.keySeparator)),S.push(...g.split(this.context.options.keySeparator)),_.push(...S),_};if(typeof o=="boolean")s?console.error(`Cannot use a boolean for ${F.listeners.value}...`):v(!0);else if(u==="string"){let g=h(f);y(g,!0),s&&(i[a]={[f]:i[a]},a=f)}else o&&u==="object"&&Go(f)&&("value"in f?s?o=i[a]=f.value:o=i[a].value=f.value:v(!0),f&&f&&(p=f),Object.defineProperty(i[a],jt,{value:p}));let x=!0;if(p){let g=F.listeners.value;if(g in p){let _=h(p[g].original??p[g]);if(typeof p[g]=="string"){let S=this.context.monitor.get(_);S?p[g]={value:S,original:p[g]}:o=`because ${_.slice(1).join(this.context.options.keySeparator)} does not point correctly to an existing component.`}else p[g].value.__parent||(o=`because ${p[g].original??r.toString()} has become unparented.`)}else{let _=F.listeners.branch,S=F.listeners.format;if(_ in p&&(p[_].find(d=>{let b=[];"if"in d&&b.push(d.if(n)),"is"in d&&b.push(d.is===n);let P=b.length>0&&b.reduce((E,O)=>E&&O,!0);return P&&"value"in d&&(n=d.value),P})||(x=!1)),S in p)try{n=p[S](n),n===void 0&&(x=!1)}catch(m){console.error("Failed to format arguments",m)}}}if(x&&n!==void 0){let g=Array.isArray(n)?n:[n];if(o===It){let _=[r];_.push(...a.split(this.context.options.keySeparator));let S=_.pop(),m=this.context.monitor.get(_,"info");m.value?m.value[S]=n:console.error(`Cannot set value on ${_.filter(d=>typeof d!="symbol").join(this.context.options.keySeparator)} from ${t}`)}else if(o?.default)o.default.call(o,...g);else if(typeof o=="function"){let _=p?.[F.listeners.bind]?.value??c.bound??this.context.instance;_?o.call(_,...g):o(...g)}else{let _=a?`listener: ${t} \u2014> ${a}`:`listener from ${t}`;i?(console.warn(`Deleting ${_}`,o),delete i[a]):console.error(`Failed to add ${_}`,o)}}};(t||o||n)&&this.setInitialProperties(t,o,n)}#e;#t;#n;#s;#r;#o},Lt=Be;var _e=e=>e.includes(l.isGraphScript)||e==="default",Ko=["Object","Array"],$o=e=>{let t=!1;return q(e,(o,n,r)=>{if(r.path.length>1&&!r.path.find(i=>i==="__")&&_e(o))return t=r.path,M},{ignore:["__","__parent"],condition:(o,n)=>{let r=n?.constructor?.name,s=n?.__props?.constructor?.name;return!(!Ko.includes(r)&&!!globalThis[r]||!!globalThis[s])}}),t};function De(e){if(!e||typeof e!="object")return null;let t=Object.entries(e).map(([n,r])=>{let s=typeof e=="object"||typeof e=="function";if(!n.includes(l.isGraphScript)&&r&&s?Object.keys(r).find(_e):!1)return{ref:r,parent:e,name:n}}).filter(n=>n&&n.ref),o=t.length>0;if(!o){let n=$o(e);if(n){let r=n.slice(0,-2),s=e;r.forEach(a=>{s=s[a],s.__=!0});let i=n[0];t=[{ref:e[i],parent:e,name:i}],o=!0}}return o?t:null}var Ue={};k(Ue,{default:()=>Uo,name:()=>zo,properties:()=>Bo,required:()=>Wo});var zo="props",Wo=!0,Bo={dependents:["__props"]},Gt,Mt=(e,t,o,n=t)=>{o||(o=T(t)),o.forEach(r=>{if(!(r in e)){let s={get:()=>n[r],set:i=>{n[r]=i},enumerable:!0,configurable:!1};n!==t&&Object.defineProperty(n,r,s),Object.defineProperty(e,r,s)}})},Do=e=>{let t=e.__props,o;return Object.defineProperty(e,"__props",{get:()=>o,set:n=>{if(typeof n!="object"&&!be(n))console.warn("Props must be an object");else{let r=T(n);if(!o)o=n,Gt=r;else{let s=o;o={},Mt(o,s,Gt)}Mt(e,n,r,o)}},enumerable:!1,configurable:!1}),t&&(e.__props=t),e},Uo=Do;var qe={};k(qe,{default:()=>Xo,name:()=>qo,properties:()=>Vo,required:()=>Jo});var Nr={dependencies:[l.isGraphScript,l.parent],dependents:[]},Ho=(e,t,o={})=>{let n=e[l.isGraphScript],r=e[l.parent],s=n.name;r=(!A&&r instanceof Element?r?.[l.component]:r)??e[l.parent];let i={value:"",writable:!0};if(r&&r[l.isGraphScript]&&typeof s=="string"){let c=r,p=[];for(;c&&c[l.isGraphScript];){let f=c[l.isGraphScript].name;if(typeof f=="string")p.push(f);else{typeof f=="symbol"?n.root=f:console.error("No graph reset occured for",f);break}c=c[l.parent]}i.value=[...p.reverse(),s],i.value=i.value.join(o.keySeparator??".")}Object.defineProperty(n,"path",i)},He=Ho;var qo="parent",Jo=!0,Vo={dependencies:[l.isGraphScript],dependents:[]},Yo=(e,t,o)=>{let n=e[l.isGraphScript];n.parent={callbacks:[],add:function(i){this.callbacks.push(i)},get:()=>s};let s=e[l.parent]??t[l.parent];Object.defineProperty(e,l.parent,{get:()=>n.parent.get(),set:i=>{let a=s&&!i;if(s?.[l.isGraphScript]){let c=n.name;delete s[c],s.__.components.delete(c)}if(s=i,s?.[l.isGraphScript]){let c=n.name;s[c]&&console.error("OVERWRITING EXISTING PROPERTY ON PARENT!"),s[c]=e,s.__.components.set(c,e)}if(n.parent.callbacks.forEach(c=>c.call(e,i)),He(e,void 0,o),a)e[l.isGraphScript].stop.run();else if(s){let c=n.connected,p=c instanceof Function;e[l.isGraphScript].start.run(),p&&c()}}}),He(e,void 0,o)},Xo=Yo;var Rt=(e,t,o,n)=>w(n,()=>e.call(t,...o)),Nt=(e,t=[],o)=>{if(e.length)if(e.length===1)Rt(e[0],o,t);else return e.reduce((n,r)=>Rt(r,o,t,n))},Zo=(e,t,o=[],n)=>e.reduce((r,s)=>w(r,i=>{let c=(typeof s=="function"?s:s.default)(i,...o);return n&&n(c)?i:c}),t),xe=(e,t,o)=>{let{main:n,overrides:r,options:s}=t,i;if(!Array.isArray(e)){if(!e[o])return n;let p=e;switch(e=p[o]??[],o){case"activate":i=[...p.load??[]];break;case"start":i=[...p.load??[],...p.activate??[]];case"stop":i=[...p.load??[],...p.activate??[],...p.start??[]];break}}let c=en(n,e,i);return c?Zo(c,n,[r,s],p=>!p||typeof p!="object"):n},Qo=e=>{let t={};return e.forEach(o=>{let n=typeof o=="function"?"activate":o.behavior??"activate";(t[n]=t[n]??[]).push(o)}),t},en=(e,t,o=[])=>{let n=T(e).filter(a=>a.slice(0,2)==="__"),s=[...Object.values(Ie),...o.map(a=>typeof a=="function"?[]:a.properties.dependents).flat()];return t.filter(a=>{if(a&&typeof a=="object"){let c=a.name,{dependencies:p,dependents:f=[]}=a.properties,u=a.required||!p;if(!u&&p){let y=c?` (${c})`:"";if(f.find(h=>n.includes(h))){let h={};p.forEach(g=>h[g]=s.includes(g));let x=p.filter(g=>!s.includes(g));x.length&&console.warn(`The loader${y} for ${p.join(", ")} might be loaded too early, since we are missing the following dependencies: ${x.join(", ")}`),u=!0}}return u&&f&&s.push(...f),u}})};function Kt(e,t="main"){let{callbacks:o}=this;return o[t].push(e),!0}function tn(e){let{callbacks:t,name:o}=this;if(!this.value){let n=o==="stop",r=e[l.isGraphScript],s=n?r.stop.initial:e[l[o]];this.value=!0,n||(r.stop.value=!1);let i=s&&!n?[...t.before,s,...t.main]:[...t.before,...t.main],a=Nt(i,[e],e);return w(a,()=>{let c=Array.from(e[l.isGraphScript].components.entries()),p=w(c.map(async([f,u])=>{let y=u[l.promise];return y&&typeof y.then=="function"&&(u=c[f]=await y),await u[l.isGraphScript][o].run()}));return w(p,()=>{let f=Nt(t.after,[e],e);return w(f,()=>{if(n){s&&s.call(e,e),r.flow.clear();let u=e[l.isGraphScript].path,y=e,v=y[l.parent];for(;v&&v[l.isGraphScript]!==void 0;){let h=y[l.parent];if(h){if(y=h,y){let x=y[l.isGraphScript];x&&x.flow.clear(u)}}else break}r.start.value=!1}return!0})})})}}function ae(e,t=[],o){let n=performance.now(),r=o.parent,{parentObject:s,toApply:i={},callbacks:a={},opts:c={},name:p=Symbol("root")}=o,f=e;if(e=ze(e,i,c),e[se])return e[se];if(Array.isArray(e))return w(e.map(g=>ae(g,t,o)));e[l.isGraphScript]=on(p,o,{parent:r,original:f,loaders:t});let u=Qo(t),y=xe(u,{main:e,overrides:i,options:c},"load"),v=w(y,g=>{let _=!g[l.parent]&&r?{[l.parent]:r}:{},S=xe([qe],{main:g,overrides:_,options:c}),m=xe([Ue],{main:S}),d=xe(u,{main:m,overrides:i,options:c},"activate");return w(d,b=>{b.__.ref=b,s&&(s[p]=b),typeof p=="symbol"&&a.onRootCreated&&a.onRootCreated(p,b),a.onInstanceCreated&&a.onInstanceCreated(b.__.path,b);let P=b[l.isGraphScript],E=De(m),O=E?E.map(R=>{let $=Object.assign({},o),X=$.name=R.name;delete $.toApply,$.parentObject=R.parent,$.parent=b;let U=R.ref;if(U)if(U.__?.symbol){let Z=U.__.parent;Z&&console.error(`Changing parent of existing component (${U.__.path}) from ${Z.__.path} to ${P.path}`),U.__parent=b,b[l.isGraphScript].components.set(X,d)}else{let Z=ae(U,t,$);Object.defineProperty(R.parent[X],l.promise,{value:Z,writable:!1});let Vt=w(Z,tt=>(P.components.set(X,tt),tt));P.components.set(X,Vt)}else delete R.parent[X],console.error("No reference found for nested component",R)}):[],G,D=new Promise(R=>G=async()=>{P.resolved=!0,R(!0)});return Object.defineProperty(b,`${l.resolved}`,{value:D}),P.resolved=!1,w(O,()=>nn(b,a,G)),b})}),x=performance.now()-n;return w(v,g=>{if(!Array.isArray(g)){let S=performance.now()-n;w(g.__resolved,()=>{let d=performance.now()-n;globalThis.escomposePerformance.resolve.push(S),globalThis.escomposePerformance.resolveAll.push(d),globalThis.escomposePerformance.create.push(x)})}}),v}function on(e,t,o={}){let{parent:n,original:r,loaders:s}=o,i=typeof e=="symbol",a=n?.[l.isGraphScript].path,p=(a?[a,e]:typeof e=="string"?[e]:[]).join(t.keySeparator??j),f={name:e,symbol:Symbol("isGraphScript"),root:i?e:n[l.isGraphScript].root,path:p,options:t,original:r,states:{},components:new Map,connected:!1,resolved:!1,flow:new Lt,create:y=>(t.loaders||(t.loaders=s),$t(y,void 0,t)),stop:{name:"stop",value:!1,add:Kt,callbacks:{before:[],main:[],after:[]}},start:{name:"start",value:!1,add:Kt,callbacks:{before:[],main:[],after:[]}}},u=function(){return tn.call(this,f.ref)};return f.start.run=u.bind(f.start),f.stop.run=u.bind(f.stop),f}function nn(e,t,o){let n=e[l.isGraphScript];for(let i in e){let a=e[i];if(typeof a=="function"&&!be(a)){let c=e[l.proxy]??e;e[i]=a.bind(c)}}n.stop.initial=e[l.stop],e[l.stop]=n.stop.run;let r=T(e);for(let i of r)if(_e(i)){let a=Object.getOwnPropertyDescriptor(e,i);a?.enumerable&&Object.defineProperty(e,i,{...a,enumerable:!1})}let s=e[l.parent];e[l.parent]=s,t.onInstanceReady&&t.onInstanceReady(e.__.path,e),o()}var rn=new re,Je=(e,t={},o={})=>{let n=Et(o),r={onRootCreated:(a,c)=>n.monitor.set(a,c,n.listeners),onInstanceCreated:(a,c)=>{if(n.listen!==!1){let p=c[l.listeners.value]??{},f=c[l.isGraphScript].flow;if(f.setInitialProperties(p,a,{id:c[l.isGraphScript].root,monitor:n.monitor,options:n}),c[l.listeners.value]=p,l.trigger in c){Array.isArray(c[l.trigger])||(c[l.trigger]=[]);let u=c[l.trigger];f.onStart(()=>c.default(...u)),delete c[l.trigger]}}},onInstanceReady:(a,c)=>c[l.isGraphScript].flow.start()},s=n.loaders,i=ae(e,s,{toApply:t,opts:n,callbacks:r,waitForChildren:!1});return w(i,a=>{let c=Array.isArray(a),p=c?a:[a];return p.map(f=>{if(f[l.parent]||f.__.path===""){let u=f[l.isGraphScript];if(u.start.value===!1){let v=u.start.run();return w(v,zt)}}else return f}),c?p:p[0]})},$t=Je;var zt=w,Wt=L;var Ye={};k(Ye,{default:()=>Dt,name:()=>un,properties:()=>dn,required:()=>mn});var Pe={};k(Pe,{default:()=>cn,define:()=>ve,name:()=>an,properties:()=>ln});var an="define",ln={dependents:[l.webcomponents],dependencies:[l.element,l.component,l.parent]},cn=e=>{let t=e[l.webcomponents]??{};for(let o in t){let n=t[o],r=n[l.element];r.name&&r.extends&&ve(r,e,n)}return e},Se={};if(!A){let e=document.createElement;document.createElement=function(t,o){let n=Se[t];return n&&!n.autonomous?e.call(this,n.tag,{is:t}):e.call(this,t,o)}}var pn={li:"LI",ol:"OL",ul:"UL",br:"BR",p:"Paragraph",textarea:"TextArea",a:"Anchor"},Ve=!1,ve=(e,t,o=t)=>{if(Se[e.name])console.log("Already created component...");else{let n=L(o),r=Ve?"":pn[e.extends]??e.extends[0].toUpperCase()+e.extends.slice(1),s=new Function(`

        class ESComponentBase extends HTML${r}Element { 
            #properties;
            constructor(properties={}){
                super()
               this.#properties = properties
            }
        }
        return ESComponentBase;

        `)();class i extends s{constructor(f){super(f);n[l.element]=this,t[l.isGraphScript].create(n)}connectedCallback(){let f=this[l.component],u=f[l.parent];f[l.parent]=u}disconnectedCallback(){console.log("Custom element removed from page.")}adoptedCallback(){console.log("Custom element moved to new page.")}attributeChangedCallback(f,u,y){console.log("Custom element attributes changed.",f,u,y)}}Se[e.name]={class:i,autonomous:Ve,tag:e.extends};let a=Se[e.name].class;Ve?customElements.define(e.name,a):customElements.define(e.name,a,{extends:e.extends})}};var fn=(e="svg",t)=>document.createElementNS("http://www.w3.org/2000/svg",e,t);var Bt=(e,t)=>e[0]==="svg"||t&&t.__element instanceof SVGElement?fn(...e):document.createElement(...e),un="element",mn=!0,dn={dependents:[l.element,l.attributes,l.resize,l.childPosition,l.editor,l.component,l.attribute,l.connected],dependencies:[l.parent,l.isGraphScript,l.proxy]};function Dt(e,t,o={}){let n=e[l.isGraphScript],r=n.states,s=n.name,i=e[l.parent],a=e[l.element],c=e[l.attributes],p;if(!(a instanceof Element)){let m="div";if(a&&typeof a=="object"&&a.name&&a.extends){let P=a,E=e[l.element];ve(E,e),e[l.element]=a=P.name}a===void 0?a=m:Array.isArray(a)?a=Bt(a,i):typeof a=="object"&&(p=a,p.selectors?a=document.querySelector(p.selectors):p.id?a=document.getElementById(p.id):a=m),typeof a=="string"&&(a=Bt([a],i));let b=Symbol("no input to the default function");e.hasOwnProperty("default")||(e.default=function(P=b){return P!==b&&(this[l.element].innerText=P),this[l.element]})}if(!(a instanceof Element))throw new Error("Element not created for "+s);let f=r||{};f.element=a,f.attributes=c,i instanceof Element?f.parentNode=i:f.parentNode=i?.[l.element]instanceof Element?i[l.element]:a.parentNode,f.onresize=e[l.resize],f.onresizeEventCallback=void 0;let u=f;typeof s!="string"&&(s=`${a.tagName??"element"}${Math.floor(Math.random()*1e15)}`),a.id||(a.id=s);let y;Object.defineProperty(e,`${l.connected}`,{value:new Promise(m=>y=async()=>{n.connected=!0,m(!0)})}),n.connected=y;let v=(m,d)=>m.slice(0,2)==="on"&&typeof d=="function",h=(m,d,b)=>!v(m,d)&&typeof d=="function"?d.call(b):d,x=m=>{if(e[l.element]instanceof Element)for(let d in m)if(d==="style")for(let b in m.style)e[l.element].style[b]=h(d,m.style[b],e);else{let b=m[d];if(v(d,b)){let P=b;e[l.element][d]=(...E)=>{let O=e[l.proxy]??e;return P.call(O??e,...E)}}else{let P=h(d,b,e);e[l.element].setAttribute(d,P);try{e[l.element][d]=P}catch{}}}};Object.defineProperty(e,l.attributes,{get:()=>u.attributes,set:m=>{u.attributes=m,u.attributes&&x(u.attributes)}}),Object.defineProperty(e,l.element,{get:function(){if(u.element instanceof Element)return u.element},set:function(m){if(m instanceof HTMLElement){u.element!==m&&(u.element.insertAdjacentElement("afterend",m),u.element.remove()),u.element=m;let d=e[l.isGraphScript];if(d){let b=d.components;for(let P in b){let E=b[P];E&&E[l.isGraphScript]&&w(E,O=>O[l.parent]=m)}}x(u.attributes)}}});let g=n.parent.get;n.parent.get=()=>{let m=g(),d=e[l.element].parentNode;return d?d.hasAttribute(l.attribute)?d[l.component]:{[l.element]:d}:m},n.parent.add(function(m){if(typeof m=="string"){let b=document.querySelector(m);b?m=b:m=document.getElementById(m)}m?.[l.element]instanceof Element&&(m=m[l.element]);let d=this[l.element].parentNode;if(d!==m)if(this[l.element]instanceof Element){if(d&&this[l.element].remove(),m instanceof Element){let b=this[l.childPosition],P=this[l.element],E=n.editor;E&&(P=E);let O=m.children.length,G=O&&b!==void 0?m.children[b]??m.children[O-1]:void 0;if(G){let $=G[l.component][l.childPosition]<b?"afterend":"beforebegin";G.insertAdjacentElement($,P)}else m.appendChild(P);E&&E.setComponent(this)}}else console.error("No element was created for this Component...",this)});let _=e[l.resize];Object.defineProperty(e,l.resize,{get:function(){return _},set:function(m){u.onresize=m,u.onresizeEventCallback&&window.removeEventListener("resize",u.onresizeEventCallback),u.onresize&&(u.onresizeEventCallback=d=>{if(u.onresize&&e[l.element]instanceof Element){let b=e[l.proxy]??e;return m.call(b,d)}},window.addEventListener("resize",u.onresizeEventCallback))}});let S=o?.utilities;if(S&&e[l.editor]){let m=e[l.editor],d=S.code?.class;if(d||(typeof m=="function"?d=m:console.error("Editor class not provided in options.utilities.code")),d){let b=S.code?.options??{};b=typeof m=="boolean"?b:{...b,...m};let P=b.bind,E=new d(b);if(E.start(),n.editor=E,P!==void 0){let O=e,G=e[l.isGraphScript];P.split("/").forEach(D=>{if(D==="..")O=O[l.isGraphScript].states.parentNode[l.component];else{if(D===".")return;O=O[D]}}),G.boundEditors?G.boundEditors.push(E):G.boundEditors=[E]}}}return e[l.element][l.component]=e,e[l.element].setAttribute(l.attribute,""),e[l.element]=e[l.element],n.start.add(()=>{e[l.resize]=u.onresize,u.parentNode&&(e[l.parent]=u.parentNode)},"before"),n.stop.add(()=>{e[l.element].remove();let m=`${l.editor}Attached`;e[m]&&e[m].remove()}),e}var Xe={};k(Xe,{default:()=>gn,name:()=>hn,properties:()=>bn,required:()=>yn});var hn="start",yn=!0,bn={dependents:[l.source],dependencies:[H,l.isGraphScript,l.editor,l.parent,l.proxy,l.connected,l.promise,l.resolved]},gn=e=>{e[l.isGraphScript].start.add(()=>xn(e))},_n=(e,t)=>e[l.isGraphScript].start.value=t;function xn(e,t=[],o){Sn.call(e,o);let n=vn.call(e,t);return _n(e,!0),n}async function Sn(e){let t=this[l.isGraphScript];await this[l.connected],t.connected=!0;let o=t.boundEditors;return o&&o.forEach(n=>n.setComponent(this)),e&&await e(),this}function vn(e=[]){let t=this[l.isGraphScript],n=this[l.parent]?.[l.isGraphScript]?.editor;n&&(t.editor=n);let r=this[H];if(r){typeof r=="function"&&(r=this[l.source]=r()),delete this[H];let s=this[l.isGraphScript].path;t.editor&&t.editor.addFile(s,r)}return e.forEach(s=>s.call(this)),this}var Qe={};k(Qe,{default:()=>Ut,name:()=>Pn,properties:()=>wn});var K={},Pn="animate",Ze=l.animate,wn={dependents:[l.animate]};function Ut(e){if(e[Ze]){let t=e[Ze],o=Math.random(),n=typeof t=="number"?t:"global",r;if(K[n])r=()=>{e.default(),K[n].objects[o]=e};else{let s=K[n]={objects:{[o]:e}},i=s.objects,a=()=>{for(let c in i)i[c].default()};if(n==="global"){let c=()=>{a(),s.id=window.requestAnimationFrame(c)};r=c,K[n].stop=()=>{window.cancelAnimationFrame(s.id),s.cancel=!0}}else r=()=>{a(),s.id=setInterval(()=>a(),1e3/n)},K[n].stop=()=>clearInterval(s.id)}e[l.isGraphScript].start.add(r),e[l.isGraphScript].stop.add(()=>{delete K[n].objects[o],e[Ze]=t,Object.keys(K[n].objects).length===0&&(K[n].stop(),delete K[n])})}}var Y=[];Y.push($e);A||Y.push(Ye,Pe);Y.push(Xe);Y.push(Qe);var Ht=Wt;var qt=(e,t,o={})=>(o.loaders?o.loaders=Array.from(new Set([...o.loaders,...Y])):o.loaders=Y,Je(e,t,o));var On=e=>{let t=document.getElementById(e);t?t.scrollIntoView({}):console.error(`No component found for path: ${e}`)},kn=!1,et=class{constructor(t){this.paths={};this.set=(t,o)=>{o===void 0?delete this.paths[t]:this.paths[t]=o};this.setRoot=t=>this.set("",t);this.get=(t=this.getPath())=>{let o=this.paths;return t.split(/\.|\//).forEach(n=>o=o[n]??o[""][n]),o};this.load=(t,o,n=!0)=>{let r=t===void 0?this.getPath():t,s=this.get(r);s&&o&&o.preventDefault();let i=!s&&(!this.loaded||this.loaded.path!=="")&&n;if(i&&(r="",s=this.get("")),s){let a=this.options.element.root,c=r?this.options.element.target:void 0;if(c){(!this.loaded||this.loaded.path!==""&&r!=="")&&this.load(""),typeof c=="string"?a=document.querySelector(c):a=c;let u=[...a.children];if(a)for(let y of u)y.remove()}else this.loaded&&this.loaded.ref.__element.remove();let p=Ht(s),f=qt(p,{__parent:a});return console.log("Loaded",r,f),r===""&&(this.root&&this.root.__element.remove(),this.root=f),this.loaded={path:r,ref:f},c&&window.scrollTo(0,0),this.loaded}else On(r);i&&this.navigate(void 0,void 0,!1)};this.navigate=(t=this.getPath(),o,n=!1)=>{let r=t.split(/\.|\//).join(this.options.spa?"/":".");history.pushState({},"escodeRouterURL",this.options.spa?`${window.location.origin}/${r}`:`${window.location.origin}#${r}`),this.load(r,o,n)};this.getPath=t=>(t===void 0&&(this.options.spa&&(t=window.location.pathname.slice(1)),t||(t=window.location.hash.slice(1))),t??"");t=Object.assign({},t),t.element||(t.element={root:document.body}),(typeof t.element!="object"||!("root"in t.element))&&(t.element={root:t.element}),this.options=t,window.addEventListener("beforeunload",o=>this.load(void 0,o)),window.addEventListener("popstate",o=>this.load(void 0,o)),window.addEventListener("DOMContentLoaded",o=>{kn=!0,(!this.loaded||this.loaded.path==="")&&this.load(void 0,o)})}},Jt=et;var we=new Jt({spa:!0,element:{root:document.body,target:"#content"}});we.setRoot(Oe);we.set("about",ke);we.set("work",Ce);we.load();
//# sourceMappingURL=index.esm.js.map
